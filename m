Return-Path: <linux-f2fs-devel-bounces@lists.sourceforge.net>
X-Original-To: lists+linux-f2fs-devel@lfdr.de
Delivered-To: lists+linux-f2fs-devel@lfdr.de
Received: from lists.sourceforge.net (lists.sourceforge.net [216.105.38.7])
	by mail.lfdr.de (Postfix) with ESMTPS id 4054A84D6CA
	for <lists+linux-f2fs-devel@lfdr.de>; Thu,  8 Feb 2024 00:52:05 +0100 (CET)
Received: from [127.0.0.1] (helo=sfs-ml-2.v29.lw.sourceforge.com)
	by sfs-ml-2.v29.lw.sourceforge.com with esmtp (Exim 4.95)
	(envelope-from <linux-f2fs-devel-bounces@lists.sourceforge.net>)
	id 1rXrhs-0006ps-1f;
	Wed, 07 Feb 2024 23:51:56 +0000
Received: from [172.30.20.202] (helo=mx.sourceforge.net)
 by sfs-ml-2.v29.lw.sourceforge.com with esmtps (TLS1.2) tls
 TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 (Exim 4.95)
 (envelope-from <daeho43@gmail.com>) id 1rXrhq-0006pg-Pe
 for linux-f2fs-devel@lists.sourceforge.net;
 Wed, 07 Feb 2024 23:51:55 +0000
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
 d=sourceforge.net; s=x; h=Content-Transfer-Encoding:Content-Type:Cc:To:
 Subject:Message-ID:Date:From:In-Reply-To:References:MIME-Version:Sender:
 Reply-To:Content-ID:Content-Description:Resent-Date:Resent-From:Resent-Sender
 :Resent-To:Resent-Cc:Resent-Message-ID:List-Id:List-Help:List-Unsubscribe:
 List-Subscribe:List-Post:List-Owner:List-Archive;
 bh=ANZ0zc1aFSyIuIePtuKB1dq4Pb5ykQDU68xmm5dP0Dk=; b=BkREWWssUSLuKz87vnX+HhxKrb
 vbN+rNwsQY0ojM+6KceIzs7HKabOlNlADMxsOCUTFixTYShbOTa+mL35edJs8TGKTta4lWu+pyqUj
 meRiTJaMd24VOoNHw25aCSL0gPZhZJ4SOIsMp9XzUQN3Sredn8ikyO+GbayqqUGd9T9Y=;
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed; d=sf.net; s=x
 ;
 h=Content-Transfer-Encoding:Content-Type:Cc:To:Subject:Message-ID:Date:From
 :In-Reply-To:References:MIME-Version:Sender:Reply-To:Content-ID:
 Content-Description:Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc
 :Resent-Message-ID:List-Id:List-Help:List-Unsubscribe:List-Subscribe:
 List-Post:List-Owner:List-Archive;
 bh=ANZ0zc1aFSyIuIePtuKB1dq4Pb5ykQDU68xmm5dP0Dk=; b=V4c+BLatan+BPoNVJBRbncx7kG
 ssMPBEGiCctCAdDcf8pMev0uY3xlWEKwKthMY6w5HyPl4eHZ/pF2vfn3ZKLy8dpCgHyQnyQL3EH6Z
 pnNE2jt7z1faa7Zeea2nHcpp18oHK6zH0JZq96m43ZtTmxo4GMdZePFhSlLo3byZGnMw=;
Received: from mail-vk1-f181.google.com ([209.85.221.181])
 by sfi-mx-2.v28.lw.sourceforge.com with esmtps
 (TLS1.2:ECDHE-RSA-AES128-GCM-SHA256:128) (Exim 4.95)
 id 1rXrho-0000uW-Ks for linux-f2fs-devel@lists.sourceforge.net;
 Wed, 07 Feb 2024 23:51:55 +0000
Received: by mail-vk1-f181.google.com with SMTP id
 71dfb90a1353d-4c0232861afso437906e0c.1
 for <linux-f2fs-devel@lists.sourceforge.net>;
 Wed, 07 Feb 2024 15:51:53 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20230601; t=1707349907; x=1707954707; darn=lists.sourceforge.net;
 h=content-transfer-encoding:cc:to:subject:message-id:date:from
 :in-reply-to:references:mime-version:from:to:cc:subject:date
 :message-id:reply-to;
 bh=ANZ0zc1aFSyIuIePtuKB1dq4Pb5ykQDU68xmm5dP0Dk=;
 b=TFPmLM/dDAE4/ad3NuFFEvb6spLjjHM0R4LMI+aza1jghsgXqhw+K+Kc/rAItXDMdG
 NE7R1kl9cgkABt35LiA7ztP8DzqqnXwhIUCLSIcyM/7/BJC2NjI4W0GvzRfKcjl2+UAv
 60I9cwQsER5UCZ1jm+Qac3BrcUv0pLYmReGqtKhok82oJMj/kUlJHv9u+bTL4b6AngvU
 gXkaLBuYTQIHB8DiXu08jj81pCVzVrARHM4Y01zwEWUfgmEFQwCWsQ5atfYeOFXhx3DY
 Ayv72PDFWKXQKeiEM/zHpRG7A23WrZgukTjvfxeIwF46VGVjB2GWFFgAzPf1xk1gpx1u
 gqdA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20230601; t=1707349907; x=1707954707;
 h=content-transfer-encoding:cc:to:subject:message-id:date:from
 :in-reply-to:references:mime-version:x-gm-message-state:from:to:cc
 :subject:date:message-id:reply-to;
 bh=ANZ0zc1aFSyIuIePtuKB1dq4Pb5ykQDU68xmm5dP0Dk=;
 b=I2jjbpbeDj8ixWXg/4VTrCYE3fNSF4Td9k3MLMeAFBjpJ3Z5MvaCR3t37RkMJOk2Ee
 E2wzPb4AiPEch89tBg0y61ig5kINcyAQJIqmH4nYeItLEwQAszx0PKF2zlBodYkqOY5U
 6xf8AouPAT1YA+DKu2aRAgYbSDYuzso5pgXTO/BTwcmpk9rjbGwpnpkmuvV39RH7gKmD
 C053RDQv3a62K4nFs33i743UhGcRWZIu8FD2F4Ojf0sg9j2migBeTCusJGW6fsbJoY9j
 z+eQ5/Sq3GowKUGlpizqRgapPrXYZXx1NVGiFmlSqT8wrg9/pMJVx8Z2837N3hOG/KJX
 LjlQ==
X-Gm-Message-State: AOJu0YyNgvJ6jwZoc0AYxRelu/rQs9sDAJstMBuy0WQVa2WocsyH8IkJ
 uzjHYwspQyVgqAPehugM5GIppJZP416K+IgUL6bO61dekTEUeebpqCaQQTZswa9cNYkY1dw1ARR
 vYjp9/hcll0UPbhLJp1iurbTDeCA=
X-Google-Smtp-Source: AGHT+IEHMyMTVOn+j+rQo7f0A0QE+QLyiNgu1emg6CAJoO7LdryoYzVQVnCAOBLPThw3SIq/z7Ip+DP2z5tZL2UosEo=
X-Received: by 2002:a05:6122:390b:b0:4c0:2036:7899 with SMTP id
 ep11-20020a056122390b00b004c020367899mr4597293vkb.4.1707349906968; Wed, 07
 Feb 2024 15:51:46 -0800 (PST)
MIME-Version: 1.0
References: <20240207005105.3744811-1-jaegeuk@kernel.org>
 <20240207005105.3744811-2-jaegeuk@kernel.org>
In-Reply-To: <20240207005105.3744811-2-jaegeuk@kernel.org>
From: Daeho Jeong <daeho43@gmail.com>
Date: Wed, 7 Feb 2024 15:51:35 -0800
Message-ID: <CACOAw_x9NvuGo3AjB5ckLsDwJ+LJaDdFefE=k+6pNeNBvkXY=A@mail.gmail.com>
To: Jaegeuk Kim <jaegeuk@kernel.org>
X-Spam-Score: 0.0 (/)
X-Spam-Report: Spam detection software, running on the system "util-spamd-2.v13.lw.sourceforge.com",
 has NOT identified this incoming email as spam.  The original
 message has been attached to this so you can view it or label
 similar future email.  If you have any questions, see
 the administrator of that system for details.
 
 Content preview:  Reviewed-by: Daeho Jeong On Tue, Feb 6, 2024 at 4:55â€¯PM
   Jaegeuk Kim wrote: > > No functional change. > > Signed-off-by: Jaegeuk Kim
    > --- > fs/f2fs/checkpoint.c | 10 ++-- > fs/f2fs/debug.c | 6 +-- > fs/f2fs/f2fs.h
    | 19 [...] 
 
 Content analysis details:   (0.0 points, 6.0 required)
 
  pts rule name              description
 ---- ---------------------- --------------------------------------------------
 -0.0 SPF_PASS               SPF: sender matches SPF record
  0.0 FREEMAIL_FROM          Sender email is commonly abused enduser mail
                             provider
                             [daeho43[at]gmail.com]
  0.0 SPF_HELO_NONE          SPF: HELO does not publish an SPF Record
  0.2 FREEMAIL_ENVFROM_END_DIGIT Envelope-from freemail username ends
                             in digit
                             [daeho43[at]gmail.com]
 -0.0 RCVD_IN_MSPIKE_H2      RBL: Average reputation (+2)
                             [209.85.221.181 listed in wl.mailspike.net]
 -0.0 RCVD_IN_DNSWL_NONE     RBL: Sender listed at https://www.dnswl.org/,
                              no trust
                             [209.85.221.181 listed in list.dnswl.org]
 -0.1 DKIM_VALID             Message has at least one valid DKIM or DK signature
  0.1 DKIM_SIGNED            Message has a DKIM or DK signature, not necessarily
                             valid
 -0.1 DKIM_VALID_AU          Message has a valid DKIM or DK signature from
                             author's domain
 -0.1 DKIM_VALID_EF          Message has a valid DKIM or DK signature from
                             envelope-from domain
 -0.0 T_SCC_BODY_TEXT_LINE   No description available.
X-Headers-End: 1rXrho-0000uW-Ks
Subject: Re: [f2fs-dev] [PATCH 2/3] f2fs: use BLKS_PER_SEG, BLKS_PER_SEC,
 and SEGS_PER_SEC
X-BeenThere: linux-f2fs-devel@lists.sourceforge.net
X-Mailman-Version: 2.1.21
Precedence: list
List-Id: <linux-f2fs-devel.lists.sourceforge.net>
List-Unsubscribe: <https://lists.sourceforge.net/lists/options/linux-f2fs-devel>, 
 <mailto:linux-f2fs-devel-request@lists.sourceforge.net?subject=unsubscribe>
List-Archive: <http://sourceforge.net/mailarchive/forum.php?forum_name=linux-f2fs-devel>
List-Post: <mailto:linux-f2fs-devel@lists.sourceforge.net>
List-Help: <mailto:linux-f2fs-devel-request@lists.sourceforge.net?subject=help>
List-Subscribe: <https://lists.sourceforge.net/lists/listinfo/linux-f2fs-devel>, 
 <mailto:linux-f2fs-devel-request@lists.sourceforge.net?subject=subscribe>
Cc: linux-kernel@vger.kernel.org, linux-f2fs-devel@lists.sourceforge.net
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linux-f2fs-devel-bounces@lists.sourceforge.net

UmV2aWV3ZWQtYnk6IERhZWhvIEplb25nIDxkYWVob2plb25nQGdvb2dsZS5jb20+CgpPbiBUdWUs
IEZlYiA2LCAyMDI0IGF0IDQ6NTXigK9QTSBKYWVnZXVrIEtpbSA8amFlZ2V1a0BrZXJuZWwub3Jn
PiB3cm90ZToKPgo+IE5vIGZ1bmN0aW9uYWwgY2hhbmdlLgo+Cj4gU2lnbmVkLW9mZi1ieTogSmFl
Z2V1ayBLaW0gPGphZWdldWtAa2VybmVsLm9yZz4KPiAtLS0KPiAgZnMvZjJmcy9jaGVja3BvaW50
LmMgfCAgMTAgKystLQo+ICBmcy9mMmZzL2RlYnVnLmMgICAgICB8ICAgNiArLS0KPiAgZnMvZjJm
cy9mMmZzLmggICAgICAgfCAgMTkgKysrKystLS0KPiAgZnMvZjJmcy9maWxlLmMgICAgICAgfCAg
MTIgKystLS0KPiAgZnMvZjJmcy9nYy5jICAgICAgICAgfCAgNDAgKysrKysrKystLS0tLS0tLQo+
ICBmcy9mMmZzL25vZGUuYyAgICAgICB8ICAgNCArLQo+ICBmcy9mMmZzL25vZGUuaCAgICAgICB8
ICAgNCArLQo+ICBmcy9mMmZzL3JlY292ZXJ5LmMgICB8ICAgMiArLQo+ICBmcy9mMmZzL3NlZ21l
bnQuYyAgICB8IDEwOSArKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0tLS0tLS0tLS0tLS0t
Cj4gIGZzL2YyZnMvc2VnbWVudC5oICAgIHwgIDE4ICsrKystLS0KPiAgZnMvZjJmcy9zdXBlci5j
ICAgICAgfCAgIDggKystLQo+ICBmcy9mMmZzL3N5c2ZzLmMgICAgICB8ICAgNiArLS0KPiAgMTIg
ZmlsZXMgY2hhbmdlZCwgMTE5IGluc2VydGlvbnMoKyksIDExOSBkZWxldGlvbnMoLSkKPgo+IGRp
ZmYgLS1naXQgYS9mcy9mMmZzL2NoZWNrcG9pbnQuYyBiL2ZzL2YyZnMvY2hlY2twb2ludC5jCj4g
aW5kZXggYjg1ODIwZTcwZjVlLi5hMDlhOTYwOWUyMjggMTAwNjQ0Cj4gLS0tIGEvZnMvZjJmcy9j
aGVja3BvaW50LmMKPiArKysgYi9mcy9mMmZzL2NoZWNrcG9pbnQuYwo+IEBAIC05MDAsNyArOTAw
LDcgQEAgc3RhdGljIHN0cnVjdCBwYWdlICp2YWxpZGF0ZV9jaGVja3BvaW50KHN0cnVjdCBmMmZz
X3NiX2luZm8gKnNiaSwKPgo+ICAgICAgICAgY3BfYmxvY2tzID0gbGUzMl90b19jcHUoY3BfYmxv
Y2stPmNwX3BhY2tfdG90YWxfYmxvY2tfY291bnQpOwo+Cj4gLSAgICAgICBpZiAoY3BfYmxvY2tz
ID4gc2JpLT5ibG9ja3NfcGVyX3NlZyB8fCBjcF9ibG9ja3MgPD0gRjJGU19DUF9QQUNLUykgewo+
ICsgICAgICAgaWYgKGNwX2Jsb2NrcyA+IEJMS1NfUEVSX1NFRyhzYmkpIHx8IGNwX2Jsb2NrcyA8
PSBGMkZTX0NQX1BBQ0tTKSB7Cj4gICAgICAgICAgICAgICAgIGYyZnNfd2FybihzYmksICJpbnZh
bGlkIGNwX3BhY2tfdG90YWxfYmxvY2tfY291bnQ6JXUiLAo+ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgbGUzMl90b19jcHUoY3BfYmxvY2stPmNwX3BhY2tfdG90YWxfYmxvY2tfY291bnQpKTsK
PiAgICAgICAgICAgICAgICAgZ290byBpbnZhbGlkX2NwOwo+IEBAIC0xMzM1LDcgKzEzMzUsNyBA
QCBzdGF0aWMgdm9pZCB1cGRhdGVfY2twdF9mbGFncyhzdHJ1Y3QgZjJmc19zYl9pbmZvICpzYmks
IHN0cnVjdCBjcF9jb250cm9sICpjcGMpCj4KPiAgICAgICAgIGlmIChjcGMtPnJlYXNvbiAmIENQ
X1VNT1VOVCkgewo+ICAgICAgICAgICAgICAgICBpZiAobGUzMl90b19jcHUoY2twdC0+Y3BfcGFj
a190b3RhbF9ibG9ja19jb3VudCkgKwo+IC0gICAgICAgICAgICAgICAgICAgICAgIE5NX0koc2Jp
KS0+bmF0X2JpdHNfYmxvY2tzID4gc2JpLT5ibG9ja3NfcGVyX3NlZykgewo+ICsgICAgICAgICAg
ICAgICAgICAgICAgIE5NX0koc2JpKS0+bmF0X2JpdHNfYmxvY2tzID4gQkxLU19QRVJfU0VHKHNi
aSkpIHsKPiAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhcl9ja3B0X2ZsYWdzKHNiaSwgQ1Bf
TkFUX0JJVFNfRkxBRyk7Cj4gICAgICAgICAgICAgICAgICAgICAgICAgZjJmc19ub3RpY2Uoc2Jp
LCAiRGlzYWJsZSBuYXRfYml0cyBkdWUgdG8gbm8gc3BhY2UiKTsKPiAgICAgICAgICAgICAgICAg
fSBlbHNlIGlmICghaXNfc2V0X2NrcHRfZmxhZ3Moc2JpLCBDUF9OQVRfQklUU19GTEFHKSAmJgo+
IEBAIC0xNTM4LDcgKzE1MzgsNyBAQCBzdGF0aWMgaW50IGRvX2NoZWNrcG9pbnQoc3RydWN0IGYy
ZnNfc2JfaW5mbyAqc2JpLCBzdHJ1Y3QgY3BfY29udHJvbCAqY3BjKQo+ICAgICAgICAgICAgICAg
ICBjcF92ZXIgfD0gKChfX3U2NCljcmMzMiA8PCAzMik7Cj4gICAgICAgICAgICAgICAgICooX19s
ZTY0ICopbm1faS0+bmF0X2JpdHMgPSBjcHVfdG9fbGU2NChjcF92ZXIpOwo+Cj4gLSAgICAgICAg
ICAgICAgIGJsayA9IHN0YXJ0X2JsayArIHNiaS0+YmxvY2tzX3Blcl9zZWcgLSBubV9pLT5uYXRf
Yml0c19ibG9ja3M7Cj4gKyAgICAgICAgICAgICAgIGJsayA9IHN0YXJ0X2JsayArIEJMS1NfUEVS
X1NFRyhzYmkpIC0gbm1faS0+bmF0X2JpdHNfYmxvY2tzOwo+ICAgICAgICAgICAgICAgICBmb3Ig
KGkgPSAwOyBpIDwgbm1faS0+bmF0X2JpdHNfYmxvY2tzOyBpKyspCj4gICAgICAgICAgICAgICAg
ICAgICAgICAgZjJmc191cGRhdGVfbWV0YV9wYWdlKHNiaSwgbm1faS0+bmF0X2JpdHMgKwo+ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoaSA8PCBGMkZTX0JMS1NJWkVf
QklUUyksIGJsayArIGkpOwo+IEBAIC0xNzQxLDkgKzE3NDEsOSBAQCB2b2lkIGYyZnNfaW5pdF9p
bm9fZW50cnlfaW5mbyhzdHJ1Y3QgZjJmc19zYl9pbmZvICpzYmkpCj4gICAgICAgICAgICAgICAg
IGltLT5pbm9fbnVtID0gMDsKPiAgICAgICAgIH0KPgo+IC0gICAgICAgc2JpLT5tYXhfb3JwaGFu
cyA9IChzYmktPmJsb2Nrc19wZXJfc2VnIC0gRjJGU19DUF9QQUNLUyAtCj4gKyAgICAgICBzYmkt
Pm1heF9vcnBoYW5zID0gKEJMS1NfUEVSX1NFRyhzYmkpIC0gRjJGU19DUF9QQUNLUyAtCj4gICAg
ICAgICAgICAgICAgICAgICAgICAgTlJfQ1VSU0VHX1BFUlNJU1RfVFlQRSAtIF9fY3BfcGF5bG9h
ZChzYmkpKSAqCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGMkZTX09SUEhBTlNf
UEVSX0JMT0NLOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIEYyRlNfT1JQSEFOU19QRVJfQkxP
Q0s7Cj4gIH0KPgo+ICBpbnQgX19pbml0IGYyZnNfY3JlYXRlX2NoZWNrcG9pbnRfY2FjaGVzKHZv
aWQpCj4gZGlmZiAtLWdpdCBhL2ZzL2YyZnMvZGVidWcuYyBiL2ZzL2YyZnMvZGVidWcuYwo+IGlu
ZGV4IGZkYmY5OTRmMTI3MS4uMGQwMjIyNGI5OWI3IDEwMDY0NAo+IC0tLSBhL2ZzL2YyZnMvZGVi
dWcuYwo+ICsrKyBiL2ZzL2YyZnMvZGVidWcuYwo+IEBAIC00MSw3ICs0MSw3IEBAIHZvaWQgZjJm
c191cGRhdGVfc2l0X2luZm8oc3RydWN0IGYyZnNfc2JfaW5mbyAqc2JpKQo+ICAgICAgICAgdG90
YWxfdmJsb2NrcyA9IDA7Cj4gICAgICAgICBibGtzX3Blcl9zZWMgPSBDQVBfQkxLU19QRVJfU0VD
KHNiaSk7Cj4gICAgICAgICBoYmxrc19wZXJfc2VjID0gYmxrc19wZXJfc2VjIC8gMjsKPiAtICAg
ICAgIGZvciAoc2Vnbm8gPSAwOyBzZWdubyA8IE1BSU5fU0VHUyhzYmkpOyBzZWdubyArPSBzYmkt
PnNlZ3NfcGVyX3NlYykgewo+ICsgICAgICAgZm9yIChzZWdubyA9IDA7IHNlZ25vIDwgTUFJTl9T
RUdTKHNiaSk7IHNlZ25vICs9IFNFR1NfUEVSX1NFQyhzYmkpKSB7Cj4gICAgICAgICAgICAgICAg
IHZibG9ja3MgPSBnZXRfdmFsaWRfYmxvY2tzKHNiaSwgc2Vnbm8sIHRydWUpOwo+ICAgICAgICAg
ICAgICAgICBkaXN0ID0gYWJzKHZibG9ja3MgLSBoYmxrc19wZXJfc2VjKTsKPiAgICAgICAgICAg
ICAgICAgYmltb2RhbCArPSBkaXN0ICogZGlzdDsKPiBAQCAtMTM1LDcgKzEzNSw3IEBAIHN0YXRp
YyB2b2lkIHVwZGF0ZV9nZW5lcmFsX3N0YXR1cyhzdHJ1Y3QgZjJmc19zYl9pbmZvICpzYmkpCj4g
ICAgICAgICBzaS0+Y3VyX2NrcHRfdGltZSA9IHNiaS0+Y3ByY19pbmZvLmN1cl90aW1lOwo+ICAg
ICAgICAgc2ktPnBlYWtfY2twdF90aW1lID0gc2JpLT5jcHJjX2luZm8ucGVha190aW1lOwo+ICAg
ICAgICAgc3Bpbl91bmxvY2soJnNiaS0+Y3ByY19pbmZvLnN0YXRfbG9jayk7Cj4gLSAgICAgICBz
aS0+dG90YWxfY291bnQgPSAoaW50KXNiaS0+dXNlcl9ibG9ja19jb3VudCAvIHNiaS0+YmxvY2tz
X3Blcl9zZWc7Cj4gKyAgICAgICBzaS0+dG90YWxfY291bnQgPSAoaW50KXNiaS0+dXNlcl9ibG9j
a19jb3VudCAvIEJMS1NfUEVSX1NFRyhzYmkpOwo+ICAgICAgICAgc2ktPnJzdmRfc2VncyA9IHJl
c2VydmVkX3NlZ21lbnRzKHNiaSk7Cj4gICAgICAgICBzaS0+b3ZlcnBfc2VncyA9IG92ZXJwcm92
aXNpb25fc2VnbWVudHMoc2JpKTsKPiAgICAgICAgIHNpLT52YWxpZF9jb3VudCA9IHZhbGlkX3Vz
ZXJfYmxvY2tzKHNiaSk7Cj4gQEAgLTIwOCw3ICsyMDgsNyBAQCBzdGF0aWMgdm9pZCB1cGRhdGVf
Z2VuZXJhbF9zdGF0dXMoc3RydWN0IGYyZnNfc2JfaW5mbyAqc2JpKQo+ICAgICAgICAgICAgICAg
ICBpZiAoIWJsa3MpCj4gICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7Cj4KPiAtICAg
ICAgICAgICAgICAgaWYgKGJsa3MgPT0gc2JpLT5ibG9ja3NfcGVyX3NlZykKPiArICAgICAgICAg
ICAgICAgaWYgKGJsa3MgPT0gQkxLU19QRVJfU0VHKHNiaSkpCj4gICAgICAgICAgICAgICAgICAg
ICAgICAgc2ktPmZ1bGxfc2VnW3R5cGVdKys7Cj4gICAgICAgICAgICAgICAgIGVsc2UKPiAgICAg
ICAgICAgICAgICAgICAgICAgICBzaS0+ZGlydHlfc2VnW3R5cGVdKys7Cj4gZGlmZiAtLWdpdCBh
L2ZzL2YyZnMvZjJmcy5oIGIvZnMvZjJmcy9mMmZzLmgKPiBpbmRleCA0YzUyMTM2Y2JjMTAuLjlh
OWU4NTgwODNhZiAxMDA2NDQKPiAtLS0gYS9mcy9mMmZzL2YyZnMuaAo+ICsrKyBiL2ZzL2YyZnMv
ZjJmcy5oCj4gQEAgLTE4MTMsNiArMTgxMywxNCBAQCBzdHJ1Y3QgZjJmc19zYl9pbmZvIHsKPiAg
I2VuZGlmCj4gIH07Cj4KPiArLyogRGVmaW5pdGlvbnMgdG8gYWNjZXNzIGYyZnNfc2JfaW5mbyAq
Lwo+ICsjZGVmaW5lIEJMS1NfUEVSX1NFRyhzYmkpICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBcCj4gKyAgICAgICAoKHNiaSktPmJsb2Nrc19wZXJfc2VnKQo+ICsjZGVmaW5l
IEJMS1NfUEVSX1NFQyhzYmkpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBc
Cj4gKyAgICAgICAoKHNiaSktPnNlZ3NfcGVyX3NlYyA8PCAoc2JpKS0+bG9nX2Jsb2Nrc19wZXJf
c2VnKQo+ICsjZGVmaW5lIFNFR1NfUEVSX1NFQyhzYmkpICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBcCj4gKyAgICAgICAoKHNiaSktPnNlZ3NfcGVyX3NlYykKPiArCj4gIF9f
cHJpbnRmKDMsIDQpCj4gIHZvaWQgZjJmc19wcmludGsoc3RydWN0IGYyZnNfc2JfaW5mbyAqc2Jp
LCBib29sIGxpbWl0X3JhdGUsIGNvbnN0IGNoYXIgKmZtdCwgLi4uKTsKPgo+IEBAIC0yNTExLDEx
ICsyNTE5LDggQEAgc3RhdGljIGlubGluZSBpbnQgZ2V0X2RpcnR5X3BhZ2VzKHN0cnVjdCBpbm9k
ZSAqaW5vZGUpCj4KPiAgc3RhdGljIGlubGluZSBpbnQgZ2V0X2Jsb2NrdHlwZV9zZWNzKHN0cnVj
dCBmMmZzX3NiX2luZm8gKnNiaSwgaW50IGJsb2NrX3R5cGUpCj4gIHsKPiAtICAgICAgIHVuc2ln
bmVkIGludCBwYWdlc19wZXJfc2VjID0gc2JpLT5zZWdzX3Blcl9zZWMgKiBzYmktPmJsb2Nrc19w
ZXJfc2VnOwo+IC0gICAgICAgdW5zaWduZWQgaW50IHNlZ3MgPSAoZ2V0X3BhZ2VzKHNiaSwgYmxv
Y2tfdHlwZSkgKyBwYWdlc19wZXJfc2VjIC0gMSkgPj4KPiAtICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBzYmktPmxvZ19ibG9ja3NfcGVyX3NlZzsKPiAtCj4g
LSAgICAgICByZXR1cm4gc2VncyAvIHNiaS0+c2Vnc19wZXJfc2VjOwo+ICsgICAgICAgcmV0dXJu
IChnZXRfcGFnZXMoc2JpLCBibG9ja190eXBlKSArIEJMS1NfUEVSX1NFQyhzYmkpIC0gMSkgLwo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
QkxLU19QRVJfU0VDKHNiaSk7Cj4gIH0KPgo+ICBzdGF0aWMgaW5saW5lIGJsb2NrX3QgdmFsaWRf
dXNlcl9ibG9ja3Moc3RydWN0IGYyZnNfc2JfaW5mbyAqc2JpKQo+IEBAIC0yNTc5LDcgKzI1ODQs
NyBAQCBzdGF0aWMgaW5saW5lIGJsb2NrX3QgX19zdGFydF9jcF9hZGRyKHN0cnVjdCBmMmZzX3Ni
X2luZm8gKnNiaSkKPiAgICAgICAgIGJsb2NrX3Qgc3RhcnRfYWRkciA9IGxlMzJfdG9fY3B1KEYy
RlNfUkFXX1NVUEVSKHNiaSktPmNwX2Jsa2FkZHIpOwo+Cj4gICAgICAgICBpZiAoc2JpLT5jdXJf
Y3BfcGFjayA9PSAyKQo+IC0gICAgICAgICAgICAgICBzdGFydF9hZGRyICs9IHNiaS0+YmxvY2tz
X3Blcl9zZWc7Cj4gKyAgICAgICAgICAgICAgIHN0YXJ0X2FkZHIgKz0gQkxLU19QRVJfU0VHKHNi
aSk7Cj4gICAgICAgICByZXR1cm4gc3RhcnRfYWRkcjsKPiAgfQo+Cj4gQEAgLTI1ODgsNyArMjU5
Myw3IEBAIHN0YXRpYyBpbmxpbmUgYmxvY2tfdCBfX3N0YXJ0X2NwX25leHRfYWRkcihzdHJ1Y3Qg
ZjJmc19zYl9pbmZvICpzYmkpCj4gICAgICAgICBibG9ja190IHN0YXJ0X2FkZHIgPSBsZTMyX3Rv
X2NwdShGMkZTX1JBV19TVVBFUihzYmkpLT5jcF9ibGthZGRyKTsKPgo+ICAgICAgICAgaWYgKHNi
aS0+Y3VyX2NwX3BhY2sgPT0gMSkKPiAtICAgICAgICAgICAgICAgc3RhcnRfYWRkciArPSBzYmkt
PmJsb2Nrc19wZXJfc2VnOwo+ICsgICAgICAgICAgICAgICBzdGFydF9hZGRyICs9IEJMS1NfUEVS
X1NFRyhzYmkpOwo+ICAgICAgICAgcmV0dXJuIHN0YXJ0X2FkZHI7Cj4gIH0KPgo+IGRpZmYgLS1n
aXQgYS9mcy9mMmZzL2ZpbGUuYyBiL2ZzL2YyZnMvZmlsZS5jCj4gaW5kZXggYzZjZDk0NzRiYTJk
Li5iMGJlNTc2YjIwOTAgMTAwNjQ0Cj4gLS0tIGEvZnMvZjJmcy9maWxlLmMKPiArKysgYi9mcy9m
MmZzL2ZpbGUuYwo+IEBAIC0yNTgwLDcgKzI1ODAsNiBAQCBzdGF0aWMgaW50IGYyZnNfZGVmcmFn
bWVudF9yYW5nZShzdHJ1Y3QgZjJmc19zYl9pbmZvICpzYmksCj4gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIC5tX21heV9jcmVhdGUgPSBmYWxzZSB9Owo+ICAgICAgICAg
c3RydWN0IGV4dGVudF9pbmZvIGVpID0ge307Cj4gICAgICAgICBwZ29mZl90IHBnX3N0YXJ0LCBw
Z19lbmQsIG5leHRfcGdvZnM7Cj4gLSAgICAgICB1bnNpZ25lZCBpbnQgYmxrX3Blcl9zZWcgPSBz
YmktPmJsb2Nrc19wZXJfc2VnOwo+ICAgICAgICAgdW5zaWduZWQgaW50IHRvdGFsID0gMCwgc2Vj
X251bTsKPiAgICAgICAgIGJsb2NrX3QgYmxrX2VuZCA9IDA7Cj4gICAgICAgICBib29sIGZyYWdt
ZW50ZWQgPSBmYWxzZTsKPiBAQCAtMjY4OSw3ICsyNjg4LDggQEAgc3RhdGljIGludCBmMmZzX2Rl
ZnJhZ21lbnRfcmFuZ2Uoc3RydWN0IGYyZnNfc2JfaW5mbyAqc2JpLAo+ICAgICAgICAgICAgICAg
ICBzZXRfaW5vZGVfZmxhZyhpbm9kZSwgRklfU0tJUF9XUklURVMpOwo+Cj4gICAgICAgICAgICAg
ICAgIGlkeCA9IG1hcC5tX2xibGs7Cj4gLSAgICAgICAgICAgICAgIHdoaWxlIChpZHggPCBtYXAu
bV9sYmxrICsgbWFwLm1fbGVuICYmIGNudCA8IGJsa19wZXJfc2VnKSB7Cj4gKyAgICAgICAgICAg
ICAgIHdoaWxlIChpZHggPCBtYXAubV9sYmxrICsgbWFwLm1fbGVuICYmCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY250IDwgQkxLU19QRVJfU0VHKHNi
aSkpIHsKPiAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgcGFnZSAqcGFnZTsKPgo+ICAg
ICAgICAgICAgICAgICAgICAgICAgIHBhZ2UgPSBmMmZzX2dldF9sb2NrX2RhdGFfcGFnZShpbm9k
ZSwgaWR4LCB0cnVlKTsKPiBAQCAtMjcwOSw3ICsyNzA5LDcgQEAgc3RhdGljIGludCBmMmZzX2Rl
ZnJhZ21lbnRfcmFuZ2Uoc3RydWN0IGYyZnNfc2JfaW5mbyAqc2JpLAo+Cj4gICAgICAgICAgICAg
ICAgIG1hcC5tX2xibGsgPSBpZHg7Cj4gIGNoZWNrOgo+IC0gICAgICAgICAgICAgICBpZiAobWFw
Lm1fbGJsayA8IHBnX2VuZCAmJiBjbnQgPCBibGtfcGVyX3NlZykKPiArICAgICAgICAgICAgICAg
aWYgKG1hcC5tX2xibGsgPCBwZ19lbmQgJiYgY250IDwgQkxLU19QRVJfU0VHKHNiaSkpCj4gICAg
ICAgICAgICAgICAgICAgICAgICAgZ290byBkb19tYXA7Cj4KPiAgICAgICAgICAgICAgICAgY2xl
YXJfaW5vZGVfZmxhZyhpbm9kZSwgRklfU0tJUF9XUklURVMpOwo+IEBAIC00MDgxLDcgKzQwODEs
NiBAQCBzdGF0aWMgaW50IGYyZnNfaW9jX2RlY29tcHJlc3NfZmlsZShzdHJ1Y3QgZmlsZSAqZmls
cCkKPiAgICAgICAgIHN0cnVjdCBmMmZzX3NiX2luZm8gKnNiaSA9IEYyRlNfSV9TQihpbm9kZSk7
Cj4gICAgICAgICBzdHJ1Y3QgZjJmc19pbm9kZV9pbmZvICpmaSA9IEYyRlNfSShpbm9kZSk7Cj4g
ICAgICAgICBwZ29mZl90IHBhZ2VfaWR4ID0gMCwgbGFzdF9pZHg7Cj4gLSAgICAgICB1bnNpZ25l
ZCBpbnQgYmxrX3Blcl9zZWcgPSBzYmktPmJsb2Nrc19wZXJfc2VnOwo+ICAgICAgICAgaW50IGNs
dXN0ZXJfc2l6ZSA9IGZpLT5pX2NsdXN0ZXJfc2l6ZTsKPiAgICAgICAgIGludCBjb3VudCwgcmV0
Owo+Cj4gQEAgLTQxMjUsNyArNDEyNCw3IEBAIHN0YXRpYyBpbnQgZjJmc19pb2NfZGVjb21wcmVz
c19maWxlKHN0cnVjdCBmaWxlICpmaWxwKQo+ICAgICAgICAgICAgICAgICBpZiAocmV0IDwgMCkK
PiAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKPgo+IC0gICAgICAgICAgICAgICBpZiAo
Z2V0X2RpcnR5X3BhZ2VzKGlub2RlKSA+PSBibGtfcGVyX3NlZykgewo+ICsgICAgICAgICAgICAg
ICBpZiAoZ2V0X2RpcnR5X3BhZ2VzKGlub2RlKSA+PSBCTEtTX1BFUl9TRUcoc2JpKSkgewo+ICAg
ICAgICAgICAgICAgICAgICAgICAgIHJldCA9IGZpbGVtYXBfZmRhdGF3cml0ZShpbm9kZS0+aV9t
YXBwaW5nKTsKPiAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmV0IDwgMCkKPiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwo+IEBAIC00MTYwLDcgKzQxNTksNiBAQCBz
dGF0aWMgaW50IGYyZnNfaW9jX2NvbXByZXNzX2ZpbGUoc3RydWN0IGZpbGUgKmZpbHApCj4gICAg
ICAgICBzdHJ1Y3QgaW5vZGUgKmlub2RlID0gZmlsZV9pbm9kZShmaWxwKTsKPiAgICAgICAgIHN0
cnVjdCBmMmZzX3NiX2luZm8gKnNiaSA9IEYyRlNfSV9TQihpbm9kZSk7Cj4gICAgICAgICBwZ29m
Zl90IHBhZ2VfaWR4ID0gMCwgbGFzdF9pZHg7Cj4gLSAgICAgICB1bnNpZ25lZCBpbnQgYmxrX3Bl
cl9zZWcgPSBzYmktPmJsb2Nrc19wZXJfc2VnOwo+ICAgICAgICAgaW50IGNsdXN0ZXJfc2l6ZSA9
IEYyRlNfSShpbm9kZSktPmlfY2x1c3Rlcl9zaXplOwo+ICAgICAgICAgaW50IGNvdW50LCByZXQ7
Cj4KPiBAQCAtNDIwMyw3ICs0MjAxLDcgQEAgc3RhdGljIGludCBmMmZzX2lvY19jb21wcmVzc19m
aWxlKHN0cnVjdCBmaWxlICpmaWxwKQo+ICAgICAgICAgICAgICAgICBpZiAocmV0IDwgMCkKPiAg
ICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKPgo+IC0gICAgICAgICAgICAgICBpZiAoZ2V0
X2RpcnR5X3BhZ2VzKGlub2RlKSA+PSBibGtfcGVyX3NlZykgewo+ICsgICAgICAgICAgICAgICBp
ZiAoZ2V0X2RpcnR5X3BhZ2VzKGlub2RlKSA+PSBCTEtTX1BFUl9TRUcoc2JpKSkgewo+ICAgICAg
ICAgICAgICAgICAgICAgICAgIHJldCA9IGZpbGVtYXBfZmRhdGF3cml0ZShpbm9kZS0+aV9tYXBw
aW5nKTsKPiAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmV0IDwgMCkKPiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwo+IGRpZmYgLS1naXQgYS9mcy9mMmZzL2djLmMg
Yi9mcy9mMmZzL2djLmMKPiBpbmRleCA2ODk5ZjQzNGFkNjguLmQ2MWE2MGMxYzg0NCAxMDA2NDQK
PiAtLS0gYS9mcy9mMmZzL2djLmMKPiArKysgYi9mcy9mMmZzL2djLmMKPiBAQCAtMjU5LDcgKzI1
OSw3IEBAIHN0YXRpYyB2b2lkIHNlbGVjdF9wb2xpY3koc3RydWN0IGYyZnNfc2JfaW5mbyAqc2Jp
LCBpbnQgZ2NfdHlwZSwKPiAgICAgICAgICAgICAgICAgcC0+b2ZzX3VuaXQgPSAxOwo+ICAgICAg
ICAgfSBlbHNlIHsKPiAgICAgICAgICAgICAgICAgcC0+Z2NfbW9kZSA9IHNlbGVjdF9nY190eXBl
KHNiaSwgZ2NfdHlwZSk7Cj4gLSAgICAgICAgICAgICAgIHAtPm9mc191bml0ID0gc2JpLT5zZWdz
X3Blcl9zZWM7Cj4gKyAgICAgICAgICAgICAgIHAtPm9mc191bml0ID0gU0VHU19QRVJfU0VDKHNi
aSk7Cj4gICAgICAgICAgICAgICAgIGlmIChfX2lzX2xhcmdlX3NlY3Rpb24oc2JpKSkgewo+ICAg
ICAgICAgICAgICAgICAgICAgICAgIHAtPmRpcnR5X2JpdG1hcCA9IGRpcnR5X2ktPmRpcnR5X3Nl
Y21hcDsKPiAgICAgICAgICAgICAgICAgICAgICAgICBwLT5tYXhfc2VhcmNoID0gY291bnRfYml0
cyhwLT5kaXJ0eV9iaXRtYXAsCj4gQEAgLTI4Miw3ICsyODIsOCBAQCBzdGF0aWMgdm9pZCBzZWxl
Y3RfcG9saWN5KHN0cnVjdCBmMmZzX3NiX2luZm8gKnNiaSwgaW50IGdjX3R5cGUsCj4KPiAgICAg
ICAgIC8qIGxldCdzIHNlbGVjdCBiZWdpbm5pbmcgaG90L3NtYWxsIHNwYWNlIGZpcnN0IGluIG5v
X2hlYXAgbW9kZSovCj4gICAgICAgICBpZiAoZjJmc19uZWVkX3JhbmRfc2VnKHNiaSkpCj4gLSAg
ICAgICAgICAgICAgIHAtPm9mZnNldCA9IGdldF9yYW5kb21fdTMyX2JlbG93KE1BSU5fU0VDUyhz
YmkpICogc2JpLT5zZWdzX3Blcl9zZWMpOwo+ICsgICAgICAgICAgICAgICBwLT5vZmZzZXQgPSBn
ZXRfcmFuZG9tX3UzMl9iZWxvdyhNQUlOX1NFQ1Moc2JpKSAqCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU0VHU19QRVJfU0VDKHNiaSkpOwo+ICAgICAg
ICAgZWxzZSBpZiAodGVzdF9vcHQoc2JpLCBOT0hFQVApICYmCj4gICAgICAgICAgICAgICAgICh0
eXBlID09IENVUlNFR19IT1RfREFUQSB8fCBJU19OT0RFU0VHKHR5cGUpKSkKPiAgICAgICAgICAg
ICAgICAgcC0+b2Zmc2V0ID0gMDsKPiBAQCAtMjk1LDEzICsyOTYsMTMgQEAgc3RhdGljIHVuc2ln
bmVkIGludCBnZXRfbWF4X2Nvc3Qoc3RydWN0IGYyZnNfc2JfaW5mbyAqc2JpLAo+ICB7Cj4gICAg
ICAgICAvKiBTU1IgYWxsb2NhdGVzIGluIGEgc2VnbWVudCB1bml0ICovCj4gICAgICAgICBpZiAo
cC0+YWxsb2NfbW9kZSA9PSBTU1IpCj4gLSAgICAgICAgICAgICAgIHJldHVybiBzYmktPmJsb2Nr
c19wZXJfc2VnOwo+ICsgICAgICAgICAgICAgICByZXR1cm4gQkxLU19QRVJfU0VHKHNiaSk7Cj4g
ICAgICAgICBlbHNlIGlmIChwLT5hbGxvY19tb2RlID09IEFUX1NTUikKPiAgICAgICAgICAgICAg
ICAgcmV0dXJuIFVJTlRfTUFYOwo+Cj4gICAgICAgICAvKiBMRlMgKi8KPiAgICAgICAgIGlmIChw
LT5nY19tb2RlID09IEdDX0dSRUVEWSkKPiAtICAgICAgICAgICAgICAgcmV0dXJuIDIgKiBzYmkt
PmJsb2Nrc19wZXJfc2VnICogcC0+b2ZzX3VuaXQ7Cj4gKyAgICAgICAgICAgICAgIHJldHVybiAy
ICogQkxLU19QRVJfU0VHKHNiaSkgKiBwLT5vZnNfdW5pdDsKPiAgICAgICAgIGVsc2UgaWYgKHAt
PmdjX21vZGUgPT0gR0NfQ0IpCj4gICAgICAgICAgICAgICAgIHJldHVybiBVSU5UX01BWDsKPiAg
ICAgICAgIGVsc2UgaWYgKHAtPmdjX21vZGUgPT0gR0NfQVQpCj4gQEAgLTQ5Niw5ICs0OTcsOSBA
QCBzdGF0aWMgdm9pZCBhZGRfdmljdGltX2VudHJ5KHN0cnVjdCBmMmZzX3NiX2luZm8gKnNiaSwK
PiAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47Cj4gICAgICAgICB9Cj4KPiAtICAgICAg
IGZvciAoaSA9IDA7IGkgPCBzYmktPnNlZ3NfcGVyX3NlYzsgaSsrKQo+ICsgICAgICAgZm9yIChp
ID0gMDsgaSA8IFNFR1NfUEVSX1NFQyhzYmkpOyBpKyspCj4gICAgICAgICAgICAgICAgIG10aW1l
ICs9IGdldF9zZWdfZW50cnkoc2JpLCBzdGFydCArIGkpLT5tdGltZTsKPiAtICAgICAgIG10aW1l
ID0gZGl2X3U2NChtdGltZSwgc2JpLT5zZWdzX3Blcl9zZWMpOwo+ICsgICAgICAgbXRpbWUgPSBk
aXZfdTY0KG10aW1lLCBTRUdTX1BFUl9TRUMoc2JpKSk7Cj4KPiAgICAgICAgIC8qIEhhbmRsZSBp
ZiB0aGUgc3lzdGVtIHRpbWUgaGFzIGNoYW5nZWQgYnkgdGhlIHVzZXIgKi8KPiAgICAgICAgIGlm
IChtdGltZSA8IHNpdF9pLT5taW5fbXRpbWUpCj4gQEAgLTU5OSw3ICs2MDAsNiBAQCBzdGF0aWMg
dm9pZCBhdHNzcl9sb29rdXBfdmljdGltKHN0cnVjdCBmMmZzX3NiX2luZm8gKnNiaSwKPiAgICAg
ICAgIHVuc2lnbmVkIGxvbmcgbG9uZyBhZ2U7Cj4gICAgICAgICB1bnNpZ25lZCBsb25nIGxvbmcg
bWF4X210aW1lID0gc2l0X2ktPmRpcnR5X21heF9tdGltZTsKPiAgICAgICAgIHVuc2lnbmVkIGxv
bmcgbG9uZyBtaW5fbXRpbWUgPSBzaXRfaS0+ZGlydHlfbWluX210aW1lOwo+IC0gICAgICAgdW5z
aWduZWQgaW50IHNlZ19ibG9ja3MgPSBzYmktPmJsb2Nrc19wZXJfc2VnOwo+ICAgICAgICAgdW5z
aWduZWQgaW50IHZibG9ja3M7Cj4gICAgICAgICB1bnNpZ25lZCBpbnQgZGlydHlfdGhyZXNob2xk
ID0gbWF4KGFtLT5tYXhfY2FuZGlkYXRlX2NvdW50LAo+ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBhbS0+Y2FuZGlkYXRlX3JhdGlvICoKPiBAQCAtNjI5LDcgKzYyOSw3
IEBAIHN0YXRpYyB2b2lkIGF0c3NyX2xvb2t1cF92aWN0aW0oc3RydWN0IGYyZnNfc2JfaW5mbyAq
c2JpLAo+ICAgICAgICAgZjJmc19idWdfb24oc2JpLCAhdmJsb2Nrcyk7Cj4KPiAgICAgICAgIC8q
IHJhcmUgY2FzZSAqLwo+IC0gICAgICAgaWYgKHZibG9ja3MgPT0gc2VnX2Jsb2NrcykKPiArICAg
ICAgIGlmICh2YmxvY2tzID09IEJMS1NfUEVSX1NFRyhzYmkpKQo+ICAgICAgICAgICAgICAgICBn
b3RvIHNraXBfbm9kZTsKPgo+ICAgICAgICAgaXRlcisrOwo+IEBAIC03NTUsNyArNzU1LDcgQEAg
aW50IGYyZnNfZ2V0X3ZpY3RpbShzdHJ1Y3QgZjJmc19zYl9pbmZvICpzYmksIHVuc2lnbmVkIGlu
dCAqcmVzdWx0LAo+ICAgICAgICAgaW50IHJldCA9IDA7Cj4KPiAgICAgICAgIG11dGV4X2xvY2so
JmRpcnR5X2ktPnNlZ2xpc3RfbG9jayk7Cj4gLSAgICAgICBsYXN0X3NlZ21lbnQgPSBNQUlOX1NF
Q1Moc2JpKSAqIHNiaS0+c2Vnc19wZXJfc2VjOwo+ICsgICAgICAgbGFzdF9zZWdtZW50ID0gTUFJ
Tl9TRUNTKHNiaSkgKiBTRUdTX1BFUl9TRUMoc2JpKTsKPgo+ICAgICAgICAgcC5hbGxvY19tb2Rl
ID0gYWxsb2NfbW9kZTsKPiAgICAgICAgIHAuYWdlID0gYWdlOwo+IEBAIC04OTYsNyArODk2LDcg
QEAgaW50IGYyZnNfZ2V0X3ZpY3RpbShzdHJ1Y3QgZjJmc19zYl9pbmZvICpzYmksIHVuc2lnbmVk
IGludCAqcmVzdWx0LAo+ICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKPiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHNtLT5sYXN0X3ZpY3RpbVtwLmdjX21vZGVdID0gc2Vnbm8g
KyBwLm9mc191bml0Owo+ICAgICAgICAgICAgICAgICAgICAgICAgIHNtLT5sYXN0X3ZpY3RpbVtw
LmdjX21vZGVdICU9Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoTUFJTl9TRUNT
KHNiaSkgKiBzYmktPnNlZ3NfcGVyX3NlYyk7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAoTUFJTl9TRUNTKHNiaSkgKiBTRUdTX1BFUl9TRUMoc2JpKSk7Cj4gICAgICAgICAgICAg
ICAgICAgICAgICAgYnJlYWs7Cj4gICAgICAgICAgICAgICAgIH0KPiAgICAgICAgIH0KPiBAQCAt
MTY3MCw3ICsxNjcwLDcgQEAgc3RhdGljIGludCBkb19nYXJiYWdlX2NvbGxlY3Qoc3RydWN0IGYy
ZnNfc2JfaW5mbyAqc2JpLAo+ICAgICAgICAgc3RydWN0IGYyZnNfc3VtbWFyeV9ibG9jayAqc3Vt
Owo+ICAgICAgICAgc3RydWN0IGJsa19wbHVnIHBsdWc7Cj4gICAgICAgICB1bnNpZ25lZCBpbnQg
c2Vnbm8gPSBzdGFydF9zZWdubzsKPiAtICAgICAgIHVuc2lnbmVkIGludCBlbmRfc2Vnbm8gPSBz
dGFydF9zZWdubyArIHNiaS0+c2Vnc19wZXJfc2VjOwo+ICsgICAgICAgdW5zaWduZWQgaW50IGVu
ZF9zZWdubyA9IHN0YXJ0X3NlZ25vICsgU0VHU19QRVJfU0VDKHNiaSk7Cj4gICAgICAgICBpbnQg
c2VnX2ZyZWVkID0gMCwgbWlncmF0ZWQgPSAwOwo+ICAgICAgICAgdW5zaWduZWQgY2hhciB0eXBl
ID0gSVNfREFUQVNFRyhnZXRfc2VnX2VudHJ5KHNiaSwgc2Vnbm8pLT50eXBlKSA/Cj4gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU1VNX1RZUEVfREFUQSA6
IFNVTV9UWVBFX05PREU7Cj4gQEAgLTE2NzgsNyArMTY3OCw3IEBAIHN0YXRpYyBpbnQgZG9fZ2Fy
YmFnZV9jb2xsZWN0KHN0cnVjdCBmMmZzX3NiX2luZm8gKnNiaSwKPiAgICAgICAgIGludCBzdWJt
aXR0ZWQgPSAwOwo+Cj4gICAgICAgICBpZiAoX19pc19sYXJnZV9zZWN0aW9uKHNiaSkpCj4gLSAg
ICAgICAgICAgICAgIGVuZF9zZWdubyA9IHJvdW5kZG93bihlbmRfc2Vnbm8sIHNiaS0+c2Vnc19w
ZXJfc2VjKTsKPiArICAgICAgICAgICAgICAgZW5kX3NlZ25vID0gcm91bmRkb3duKGVuZF9zZWdu
bywgU0VHU19QRVJfU0VDKHNiaSkpOwo+Cj4gICAgICAgICAvKgo+ICAgICAgICAgICogem9uZS1j
YXBhY2l0eSBjYW4gYmUgbGVzcyB0aGFuIHpvbmUtc2l6ZSBpbiB6b25lZCBkZXZpY2VzLAo+IEBA
IC0xNjg2LDcgKzE2ODYsNyBAQCBzdGF0aWMgaW50IGRvX2dhcmJhZ2VfY29sbGVjdChzdHJ1Y3Qg
ZjJmc19zYl9pbmZvICpzYmksCj4gICAgICAgICAgKiBjYWxjdWxhdGUgdGhlIGVuZCBzZWdubyBp
biB0aGUgem9uZSB3aGljaCBjYW4gYmUgZ2FyYmFnZSBjb2xsZWN0ZWQKPiAgICAgICAgICAqLwo+
ICAgICAgICAgaWYgKGYyZnNfc2JfaGFzX2Jsa3pvbmVkKHNiaSkpCj4gLSAgICAgICAgICAgICAg
IGVuZF9zZWdubyAtPSBzYmktPnNlZ3NfcGVyX3NlYyAtCj4gKyAgICAgICAgICAgICAgIGVuZF9z
ZWdubyAtPSBTRUdTX1BFUl9TRUMoc2JpKSAtCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGYyZnNfdXNhYmxlX3NlZ3NfaW5fc2VjKHNiaSwgc2Vnbm8pOwo+Cj4gICAg
ICAgICBzYW5pdHlfY2hlY2tfc2VnX3R5cGUoc2JpLCBnZXRfc2VnX2VudHJ5KHNiaSwgc2Vnbm8p
LT50eXBlKTsKPiBAQCAtMTk4Niw3ICsxOTg2LDcgQEAgc3RhdGljIGludCBmcmVlX3NlZ21lbnRf
cmFuZ2Uoc3RydWN0IGYyZnNfc2JfaW5mbyAqc2JpLAo+Cj4gICAgICAgICAvKiBGb3JjZSBibG9j
ayBhbGxvY2F0aW9uIGZvciBHQyAqLwo+ICAgICAgICAgTUFJTl9TRUNTKHNiaSkgLT0gc2VjczsK
PiAtICAgICAgIHN0YXJ0ID0gTUFJTl9TRUNTKHNiaSkgKiBzYmktPnNlZ3NfcGVyX3NlYzsKPiAr
ICAgICAgIHN0YXJ0ID0gTUFJTl9TRUNTKHNiaSkgKiBTRUdTX1BFUl9TRUMoc2JpKTsKPiAgICAg
ICAgIGVuZCA9IE1BSU5fU0VHUyhzYmkpIC0gMTsKPgo+ICAgICAgICAgbXV0ZXhfbG9jaygmRElS
VFlfSShzYmkpLT5zZWdsaXN0X2xvY2spOwo+IEBAIC0yMDA0LDcgKzIwMDQsNyBAQCBzdGF0aWMg
aW50IGZyZWVfc2VnbWVudF9yYW5nZShzdHJ1Y3QgZjJmc19zYl9pbmZvICpzYmksCj4gICAgICAg
ICAgICAgICAgIGYyZnNfYWxsb2NhdGVfc2VnbWVudF9mb3JfcmVzaXplKHNiaSwgdHlwZSwgc3Rh
cnQsIGVuZCk7Cj4KPiAgICAgICAgIC8qIGRvIEdDIHRvIG1vdmUgb3V0IHZhbGlkIGJsb2NrcyBp
biB0aGUgcmFuZ2UgKi8KPiAtICAgICAgIGZvciAoc2Vnbm8gPSBzdGFydDsgc2Vnbm8gPD0gZW5k
OyBzZWdubyArPSBzYmktPnNlZ3NfcGVyX3NlYykgewo+ICsgICAgICAgZm9yIChzZWdubyA9IHN0
YXJ0OyBzZWdubyA8PSBlbmQ7IHNlZ25vICs9IFNFR1NfUEVSX1NFQyhzYmkpKSB7Cj4gICAgICAg
ICAgICAgICAgIHN0cnVjdCBnY19pbm9kZV9saXN0IGdjX2xpc3QgPSB7Cj4gICAgICAgICAgICAg
ICAgICAgICAgICAgLmlsaXN0ID0gTElTVF9IRUFEX0lOSVQoZ2NfbGlzdC5pbGlzdCksCj4gICAg
ICAgICAgICAgICAgICAgICAgICAgLmlyb290ID0gUkFESVhfVFJFRV9JTklUKGdjX2xpc3QuaXJv
b3QsIEdGUF9OT0ZTKSwKPiBAQCAtMjA0OCw3ICsyMDQ4LDcgQEAgc3RhdGljIHZvaWQgdXBkYXRl
X3NiX21ldGFkYXRhKHN0cnVjdCBmMmZzX3NiX2luZm8gKnNiaSwgaW50IHNlY3MpCj4gICAgICAg
ICBpbnQgc2VnbWVudF9jb3VudDsKPiAgICAgICAgIGludCBzZWdtZW50X2NvdW50X21haW47Cj4g
ICAgICAgICBsb25nIGxvbmcgYmxvY2tfY291bnQ7Cj4gLSAgICAgICBpbnQgc2VncyA9IHNlY3Mg
KiBzYmktPnNlZ3NfcGVyX3NlYzsKPiArICAgICAgIGludCBzZWdzID0gc2VjcyAqIFNFR1NfUEVS
X1NFQyhzYmkpOwo+Cj4gICAgICAgICBmMmZzX2Rvd25fd3JpdGUoJnNiaS0+c2JfbG9jayk7Cj4K
PiBAQCAtMjA2MSw3ICsyMDYxLDcgQEAgc3RhdGljIHZvaWQgdXBkYXRlX3NiX21ldGFkYXRhKHN0
cnVjdCBmMmZzX3NiX2luZm8gKnNiaSwgaW50IHNlY3MpCj4gICAgICAgICByYXdfc2ItPnNlZ21l
bnRfY291bnQgPSBjcHVfdG9fbGUzMihzZWdtZW50X2NvdW50ICsgc2Vncyk7Cj4gICAgICAgICBy
YXdfc2ItPnNlZ21lbnRfY291bnRfbWFpbiA9IGNwdV90b19sZTMyKHNlZ21lbnRfY291bnRfbWFp
biArIHNlZ3MpOwo+ICAgICAgICAgcmF3X3NiLT5ibG9ja19jb3VudCA9IGNwdV90b19sZTY0KGJs
b2NrX2NvdW50ICsKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGxv
bmcgbG9uZylzZWdzICogc2JpLT5ibG9ja3NfcGVyX3NlZyk7Cj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgKGxvbmcgbG9uZykoc2VncyA8PCBzYmktPmxvZ19ibG9ja3NfcGVyX3NlZykpOwo+ICAg
ICAgICAgaWYgKGYyZnNfaXNfbXVsdGlfZGV2aWNlKHNiaSkpIHsKPiAgICAgICAgICAgICAgICAg
aW50IGxhc3RfZGV2ID0gc2JpLT5zX25kZXZzIC0gMTsKPiAgICAgICAgICAgICAgICAgaW50IGRl
dl9zZWdzID0KPiBAQCAtMjA3Niw4ICsyMDc2LDggQEAgc3RhdGljIHZvaWQgdXBkYXRlX3NiX21l
dGFkYXRhKHN0cnVjdCBmMmZzX3NiX2luZm8gKnNiaSwgaW50IHNlY3MpCj4KPiAgc3RhdGljIHZv
aWQgdXBkYXRlX2ZzX21ldGFkYXRhKHN0cnVjdCBmMmZzX3NiX2luZm8gKnNiaSwgaW50IHNlY3Mp
Cj4gIHsKPiAtICAgICAgIGludCBzZWdzID0gc2VjcyAqIHNiaS0+c2Vnc19wZXJfc2VjOwo+IC0g
ICAgICAgbG9uZyBsb25nIGJsa3MgPSAobG9uZyBsb25nKXNlZ3MgKiBzYmktPmJsb2Nrc19wZXJf
c2VnOwo+ICsgICAgICAgaW50IHNlZ3MgPSBzZWNzICogU0VHU19QRVJfU0VDKHNiaSk7Cj4gKyAg
ICAgICBsb25nIGxvbmcgYmxrcyA9IChsb25nIGxvbmcpKHNlZ3MgPDwgc2JpLT5sb2dfYmxvY2tz
X3Blcl9zZWcpOwo+ICAgICAgICAgbG9uZyBsb25nIHVzZXJfYmxvY2tfY291bnQgPQo+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgbGU2NF90b19jcHUoRjJGU19DS1BUKHNiaSktPnVz
ZXJfYmxvY2tfY291bnQpOwo+Cj4gQEAgLTIxMTksNyArMjExOSw3IEBAIGludCBmMmZzX3Jlc2l6
ZV9mcyhzdHJ1Y3QgZmlsZSAqZmlscCwgX191NjQgYmxvY2tfY291bnQpCj4gICAgICAgICAgICAg
ICAgIGludCBsYXN0X2RldiA9IHNiaS0+c19uZGV2cyAtIDE7Cj4gICAgICAgICAgICAgICAgIF9f
dTY0IGxhc3Rfc2VncyA9IEZERVYobGFzdF9kZXYpLnRvdGFsX3NlZ21lbnRzOwo+Cj4gLSAgICAg
ICAgICAgICAgIGlmIChibG9ja19jb3VudCArIGxhc3Rfc2VncyAqIHNiaS0+YmxvY2tzX3Blcl9z
ZWcgPD0KPiArICAgICAgICAgICAgICAgaWYgKGJsb2NrX2NvdW50ICsgKGxhc3Rfc2VncyA8PCBz
YmktPmxvZ19ibG9ja3NfcGVyX3NlZykgPD0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2xkX2Jsb2NrX2NvdW50KQo+ICAg
ICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOwo+ICAgICAgICAgfQo+IGRpZmYg
LS1naXQgYS9mcy9mMmZzL25vZGUuYyBiL2ZzL2YyZnMvbm9kZS5jCj4gaW5kZXggMWQ4OThhMTZm
MDVhLi41MTI0MTk5NmI5ZWMgMTAwNjQ0Cj4gLS0tIGEvZnMvZjJmcy9ub2RlLmMKPiArKysgYi9m
cy9mMmZzL25vZGUuYwo+IEBAIC0yODQxLDcgKzI4NDEsNyBAQCBpbnQgZjJmc19yZXN0b3JlX25v
ZGVfc3VtbWFyeShzdHJ1Y3QgZjJmc19zYl9pbmZvICpzYmksCj4gICAgICAgICBpbnQgaSwgaWR4
LCBsYXN0X29mZnNldCwgbnJwYWdlczsKPgo+ICAgICAgICAgLyogc2NhbiB0aGUgbm9kZSBzZWdt
ZW50ICovCj4gLSAgICAgICBsYXN0X29mZnNldCA9IHNiaS0+YmxvY2tzX3Blcl9zZWc7Cj4gKyAg
ICAgICBsYXN0X29mZnNldCA9IEJMS1NfUEVSX1NFRyhzYmkpOwo+ICAgICAgICAgYWRkciA9IFNU
QVJUX0JMT0NLKHNiaSwgc2Vnbm8pOwo+ICAgICAgICAgc3VtX2VudHJ5ID0gJnN1bS0+ZW50cmll
c1swXTsKPgo+IEBAIC0zMTU4LDcgKzMxNTgsNyBAQCBzdGF0aWMgaW50IF9fZ2V0X25hdF9iaXRt
YXBzKHN0cnVjdCBmMmZzX3NiX2luZm8gKnNiaSkKPiAgICAgICAgIGlmICghaXNfc2V0X2NrcHRf
ZmxhZ3Moc2JpLCBDUF9OQVRfQklUU19GTEFHKSkKPiAgICAgICAgICAgICAgICAgcmV0dXJuIDA7
Cj4KPiAtICAgICAgIG5hdF9iaXRzX2FkZHIgPSBfX3N0YXJ0X2NwX2FkZHIoc2JpKSArIHNiaS0+
YmxvY2tzX3Blcl9zZWcgLQo+ICsgICAgICAgbmF0X2JpdHNfYWRkciA9IF9fc3RhcnRfY3BfYWRk
cihzYmkpICsgQkxLU19QRVJfU0VHKHNiaSkgLQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIG5tX2ktPm5hdF9iaXRzX2Jsb2NrczsKPiAgICAgICAgIGZv
ciAoaSA9IDA7IGkgPCBubV9pLT5uYXRfYml0c19ibG9ja3M7IGkrKykgewo+ICAgICAgICAgICAg
ICAgICBzdHJ1Y3QgcGFnZSAqcGFnZTsKPiBkaWZmIC0tZ2l0IGEvZnMvZjJmcy9ub2RlLmggYi9m
cy9mMmZzL25vZGUuaAo+IGluZGV4IDViZDE2YTk1ZWVmOC4uNmFlYTEzMDI0YWMxIDEwMDY0NAo+
IC0tLSBhL2ZzL2YyZnMvbm9kZS5oCj4gKysrIGIvZnMvZjJmcy9ub2RlLmgKPiBAQCAtMjA4LDEw
ICsyMDgsMTAgQEAgc3RhdGljIGlubGluZSBwZ29mZl90IGN1cnJlbnRfbmF0X2FkZHIoc3RydWN0
IGYyZnNfc2JfaW5mbyAqc2JpLCBuaWRfdCBzdGFydCkKPgo+ICAgICAgICAgYmxvY2tfYWRkciA9
IChwZ29mZl90KShubV9pLT5uYXRfYmxrYWRkciArCj4gICAgICAgICAgICAgICAgIChibG9ja19v
ZmYgPDwgMSkgLQo+IC0gICAgICAgICAgICAgICAoYmxvY2tfb2ZmICYgKHNiaS0+YmxvY2tzX3Bl
cl9zZWcgLSAxKSkpOwo+ICsgICAgICAgICAgICAgICAoYmxvY2tfb2ZmICYgKEJMS1NfUEVSX1NF
RyhzYmkpIC0gMSkpKTsKPgo+ICAgICAgICAgaWYgKGYyZnNfdGVzdF9iaXQoYmxvY2tfb2ZmLCBu
bV9pLT5uYXRfYml0bWFwKSkKPiAtICAgICAgICAgICAgICAgYmxvY2tfYWRkciArPSBzYmktPmJs
b2Nrc19wZXJfc2VnOwo+ICsgICAgICAgICAgICAgICBibG9ja19hZGRyICs9IEJMS1NfUEVSX1NF
RyhzYmkpOwo+Cj4gICAgICAgICByZXR1cm4gYmxvY2tfYWRkcjsKPiAgfQo+IGRpZmYgLS1naXQg
YS9mcy9mMmZzL3JlY292ZXJ5LmMgYi9mcy9mMmZzL3JlY292ZXJ5LmMKPiBpbmRleCBhYWQxZDFh
OWIzZDYuLmIzYmFlYzY2NmFmZSAxMDA2NDQKPiAtLS0gYS9mcy9mMmZzL3JlY292ZXJ5LmMKPiAr
KysgYi9mcy9mMmZzL3JlY292ZXJ5LmMKPiBAQCAtMzU0LDcgKzM1NCw3IEBAIHN0YXRpYyB1bnNp
Z25lZCBpbnQgYWRqdXN0X3Bvcl9yYV9ibG9ja3Moc3RydWN0IGYyZnNfc2JfaW5mbyAqc2JpLAo+
ICAgICAgICAgaWYgKGJsa2FkZHIgKyAxID09IG5leHRfYmxrYWRkcikKPiAgICAgICAgICAgICAg
ICAgcmFfYmxvY2tzID0gbWluX3QodW5zaWduZWQgaW50LCBSRUNPVkVSWV9NQVhfUkFfQkxPQ0tT
LAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgcmFfYmxvY2tzICogMik7Cj4gLSAgICAgICBlbHNlIGlmIChuZXh0X2Jsa2FkZHIgJSBzYmkt
PmJsb2Nrc19wZXJfc2VnKQo+ICsgICAgICAgZWxzZSBpZiAobmV4dF9ibGthZGRyICUgQkxLU19Q
RVJfU0VHKHNiaSkpCj4gICAgICAgICAgICAgICAgIHJhX2Jsb2NrcyA9IG1heF90KHVuc2lnbmVk
IGludCwgUkVDT1ZFUllfTUlOX1JBX0JMT0NLUywKPiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhX2Jsb2NrcyAvIDIpOwo+ICAgICAgICAg
cmV0dXJuIHJhX2Jsb2NrczsKPiBkaWZmIC0tZ2l0IGEvZnMvZjJmcy9zZWdtZW50LmMgYi9mcy9m
MmZzL3NlZ21lbnQuYwo+IGluZGV4IGU1NzU5ODEzMjc2YS4uOGQzMzA2NjRiOTI1IDEwMDY0NAo+
IC0tLSBhL2ZzL2YyZnMvc2VnbWVudC5jCj4gKysrIGIvZnMvZjJmcy9zZWdtZW50LmMKPiBAQCAt
NDQ4LDggKzQ0OCw4IEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBleGNlc3NfZGlydHlfdGhyZXNob2xk
KHN0cnVjdCBmMmZzX3NiX2luZm8gKnNiaSkKPiAgICAgICAgIHVuc2lnbmVkIGludCBub2RlcyA9
IGdldF9wYWdlcyhzYmksIEYyRlNfRElSVFlfTk9ERVMpOwo+ICAgICAgICAgdW5zaWduZWQgaW50
IG1ldGEgPSBnZXRfcGFnZXMoc2JpLCBGMkZTX0RJUlRZX01FVEEpOwo+ICAgICAgICAgdW5zaWdu
ZWQgaW50IGltZXRhID0gZ2V0X3BhZ2VzKHNiaSwgRjJGU19ESVJUWV9JTUVUQSk7Cj4gLSAgICAg
ICB1bnNpZ25lZCBpbnQgdGhyZXNob2xkID0gc2JpLT5ibG9ja3NfcGVyX3NlZyAqIGZhY3RvciAq
Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERFRkFVTFRfRElSVFlf
VEhSRVNIT0xEOwo+ICsgICAgICAgdW5zaWduZWQgaW50IHRocmVzaG9sZCA9IChmYWN0b3IgKiBE
RUZBVUxUX0RJUlRZX1RIUkVTSE9MRCkgPDwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHNiaS0+bG9nX2Jsb2Nrc19wZXJfc2VnOwo+ICAgICAgICAgdW5zaWduZWQgaW50IGdsb2Jh
bF90aHJlc2hvbGQgPSB0aHJlc2hvbGQgKiAzIC8gMjsKPgo+ICAgICAgICAgaWYgKGRlbnRzID49
IHRocmVzaG9sZCB8fCBxZGF0YSA+PSB0aHJlc2hvbGQgfHwKPiBAQCAtMTEzNCw4ICsxMTM0LDcg
QEAgc3RhdGljIHZvaWQgX19jaGVja19zaXRfYml0bWFwKHN0cnVjdCBmMmZzX3NiX2luZm8gKnNi
aSwKPiAgICAgICAgIHN0cnVjdCBzZWdfZW50cnkgKnNlbnRyeTsKPiAgICAgICAgIHVuc2lnbmVk
IGludCBzZWdubzsKPiAgICAgICAgIGJsb2NrX3QgYmxrID0gc3RhcnQ7Cj4gLSAgICAgICB1bnNp
Z25lZCBsb25nIG9mZnNldCwgc2l6ZSwgbWF4X2Jsb2NrcyA9IHNiaS0+YmxvY2tzX3Blcl9zZWc7
Cj4gLSAgICAgICB1bnNpZ25lZCBsb25nICptYXA7Cj4gKyAgICAgICB1bnNpZ25lZCBsb25nIG9m
ZnNldCwgc2l6ZSwgKm1hcDsKPgo+ICAgICAgICAgd2hpbGUgKGJsayA8IGVuZCkgewo+ICAgICAg
ICAgICAgICAgICBzZWdubyA9IEdFVF9TRUdOTyhzYmksIGJsayk7Cj4gQEAgLTExNDUsNyArMTE0
NCw3IEBAIHN0YXRpYyB2b2lkIF9fY2hlY2tfc2l0X2JpdG1hcChzdHJ1Y3QgZjJmc19zYl9pbmZv
ICpzYmksCj4gICAgICAgICAgICAgICAgIGlmIChlbmQgPCBTVEFSVF9CTE9DSyhzYmksIHNlZ25v
ICsgMSkpCj4gICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZSA9IEdFVF9CTEtPRkZfRlJPTV9T
RUcwKHNiaSwgZW5kKTsKPiAgICAgICAgICAgICAgICAgZWxzZQo+IC0gICAgICAgICAgICAgICAg
ICAgICAgIHNpemUgPSBtYXhfYmxvY2tzOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIHNpemUg
PSBCTEtTX1BFUl9TRUcoc2JpKTsKPiAgICAgICAgICAgICAgICAgbWFwID0gKHVuc2lnbmVkIGxv
bmcgKikoc2VudHJ5LT5jdXJfdmFsaWRfbWFwKTsKPiAgICAgICAgICAgICAgICAgb2Zmc2V0ID0g
X19maW5kX3Jldl9uZXh0X2JpdChtYXAsIHNpemUsIG9mZnNldCk7Cj4gICAgICAgICAgICAgICAg
IGYyZnNfYnVnX29uKHNiaSwgb2Zmc2V0ICE9IHNpemUpOwo+IEBAIC0yMDQ0LDcgKzIwNDMsNiBA
QCBzdGF0aWMgYm9vbCBhZGRfZGlzY2FyZF9hZGRycyhzdHJ1Y3QgZjJmc19zYl9pbmZvICpzYmks
IHN0cnVjdCBjcF9jb250cm9sICpjcGMsCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBib29sIGNoZWNrX29ubHkpCj4gIHsKPiAgICAgICAg
IGludCBlbnRyaWVzID0gU0lUX1ZCTE9DS19NQVBfU0laRSAvIHNpemVvZih1bnNpZ25lZCBsb25n
KTsKPiAtICAgICAgIGludCBtYXhfYmxvY2tzID0gc2JpLT5ibG9ja3NfcGVyX3NlZzsKPiAgICAg
ICAgIHN0cnVjdCBzZWdfZW50cnkgKnNlID0gZ2V0X3NlZ19lbnRyeShzYmksIGNwYy0+dHJpbV9z
dGFydCk7Cj4gICAgICAgICB1bnNpZ25lZCBsb25nICpjdXJfbWFwID0gKHVuc2lnbmVkIGxvbmcg
KilzZS0+Y3VyX3ZhbGlkX21hcDsKPiAgICAgICAgIHVuc2lnbmVkIGxvbmcgKmNrcHRfbWFwID0g
KHVuc2lnbmVkIGxvbmcgKilzZS0+Y2twdF92YWxpZF9tYXA7Cj4gQEAgLTIwNTYsOCArMjA1NCw5
IEBAIHN0YXRpYyBib29sIGFkZF9kaXNjYXJkX2FkZHJzKHN0cnVjdCBmMmZzX3NiX2luZm8gKnNi
aSwgc3RydWN0IGNwX2NvbnRyb2wgKmNwYywKPiAgICAgICAgIHN0cnVjdCBsaXN0X2hlYWQgKmhl
YWQgPSAmU01fSShzYmkpLT5kY2NfaW5mby0+ZW50cnlfbGlzdDsKPiAgICAgICAgIGludCBpOwo+
Cj4gLSAgICAgICBpZiAoc2UtPnZhbGlkX2Jsb2NrcyA9PSBtYXhfYmxvY2tzIHx8ICFmMmZzX2h3
X3N1cHBvcnRfZGlzY2FyZChzYmkpIHx8Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgIWYyZnNf
YmxvY2tfdW5pdF9kaXNjYXJkKHNiaSkpCj4gKyAgICAgICBpZiAoc2UtPnZhbGlkX2Jsb2NrcyA9
PSBCTEtTX1BFUl9TRUcoc2JpKSB8fAo+ICsgICAgICAgICAgICFmMmZzX2h3X3N1cHBvcnRfZGlz
Y2FyZChzYmkpIHx8Cj4gKyAgICAgICAgICAgIWYyZnNfYmxvY2tfdW5pdF9kaXNjYXJkKHNiaSkp
Cj4gICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKPgo+ICAgICAgICAgaWYgKCFmb3JjZSkg
ewo+IEBAIC0yMDc0LDEzICsyMDczLDE0IEBAIHN0YXRpYyBib29sIGFkZF9kaXNjYXJkX2FkZHJz
KHN0cnVjdCBmMmZzX3NiX2luZm8gKnNiaSwgc3RydWN0IGNwX2NvbnRyb2wgKmNwYywKPgo+ICAg
ICAgICAgd2hpbGUgKGZvcmNlIHx8IFNNX0koc2JpKS0+ZGNjX2luZm8tPm5yX2Rpc2NhcmRzIDw9
Cj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTTV9JKHNiaSktPmRjY19pbmZvLT5t
YXhfZGlzY2FyZHMpIHsKPiAtICAgICAgICAgICAgICAgc3RhcnQgPSBfX2ZpbmRfcmV2X25leHRf
Yml0KGRtYXAsIG1heF9ibG9ja3MsIGVuZCArIDEpOwo+IC0gICAgICAgICAgICAgICBpZiAoc3Rh
cnQgPj0gbWF4X2Jsb2NrcykKPiArICAgICAgICAgICAgICAgc3RhcnQgPSBfX2ZpbmRfcmV2X25l
eHRfYml0KGRtYXAsIEJMS1NfUEVSX1NFRyhzYmkpLCBlbmQgKyAxKTsKPiArICAgICAgICAgICAg
ICAgaWYgKHN0YXJ0ID49IEJMS1NfUEVSX1NFRyhzYmkpKQo+ICAgICAgICAgICAgICAgICAgICAg
ICAgIGJyZWFrOwo+Cj4gLSAgICAgICAgICAgICAgIGVuZCA9IF9fZmluZF9yZXZfbmV4dF96ZXJv
X2JpdChkbWFwLCBtYXhfYmxvY2tzLCBzdGFydCArIDEpOwo+IC0gICAgICAgICAgICAgICBpZiAo
Zm9yY2UgJiYgc3RhcnQgJiYgZW5kICE9IG1heF9ibG9ja3MKPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgJiYgKGVuZCAtIHN0YXJ0KSA8IGNwYy0+dHJpbV9taW5sZW4p
Cj4gKyAgICAgICAgICAgICAgIGVuZCA9IF9fZmluZF9yZXZfbmV4dF96ZXJvX2JpdChkbWFwLAo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJMS1NfUEVS
X1NFRyhzYmkpLCBzdGFydCArIDEpOwo+ICsgICAgICAgICAgICAgICBpZiAoZm9yY2UgJiYgc3Rh
cnQgJiYgZW5kICE9IEJMS1NfUEVSX1NFRyhzYmkpICYmCj4gKyAgICAgICAgICAgICAgICAgICAo
ZW5kIC0gc3RhcnQpIDwgY3BjLT50cmltX21pbmxlbikKPiAgICAgICAgICAgICAgICAgICAgICAg
ICBjb250aW51ZTsKPgo+ICAgICAgICAgICAgICAgICBpZiAoY2hlY2tfb25seSkKPiBAQCAtMjE2
Miw4ICsyMTYyLDggQEAgdm9pZCBmMmZzX2NsZWFyX3ByZWZyZWVfc2VnbWVudHMoc3RydWN0IGYy
ZnNfc2JfaW5mbyAqc2JpLAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydCArIDEpOwo+Cj4gICAgICAgICAgICAgICAg
IGlmIChzZWN0aW9uX2FsaWdubWVudCkgewo+IC0gICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0
ID0gcm91bmRkb3duKHN0YXJ0LCBzYmktPnNlZ3NfcGVyX3NlYyk7Cj4gLSAgICAgICAgICAgICAg
ICAgICAgICAgZW5kID0gcm91bmR1cChlbmQsIHNiaS0+c2Vnc19wZXJfc2VjKTsKPiArICAgICAg
ICAgICAgICAgICAgICAgICBzdGFydCA9IHJvdW5kZG93bihzdGFydCwgU0VHU19QRVJfU0VDKHNi
aSkpOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIGVuZCA9IHJvdW5kdXAoZW5kLCBTRUdTX1BF
Ul9TRUMoc2JpKSk7Cj4gICAgICAgICAgICAgICAgIH0KPgo+ICAgICAgICAgICAgICAgICBmb3Ig
KGkgPSBzdGFydDsgaSA8IGVuZDsgaSsrKSB7Cj4gQEAgLTIxOTEsOSArMjE5MSw5IEBAIHZvaWQg
ZjJmc19jbGVhcl9wcmVmcmVlX3NlZ21lbnRzKHN0cnVjdCBmMmZzX3NiX2luZm8gKnNiaSwKPiAg
ICAgICAgICAgICAgICAgaWYgKCFJU19DVVJTRUMoc2JpLCBzZWNubykgJiYKPiAgICAgICAgICAg
ICAgICAgICAgICAgICAhZ2V0X3ZhbGlkX2Jsb2NrcyhzYmksIHN0YXJ0LCB0cnVlKSkKPiAgICAg
ICAgICAgICAgICAgICAgICAgICBmMmZzX2lzc3VlX2Rpc2NhcmQoc2JpLCBTVEFSVF9CTE9DSyhz
YmksIHN0YXJ0X3NlZ25vKSwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNiaS0+
c2Vnc19wZXJfc2VjIDw8IHNiaS0+bG9nX2Jsb2Nrc19wZXJfc2VnKTsKPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCTEtTX1BFUl9TRUMoc2JpKSk7Cj4K
PiAtICAgICAgICAgICAgICAgc3RhcnQgPSBzdGFydF9zZWdubyArIHNiaS0+c2Vnc19wZXJfc2Vj
Owo+ICsgICAgICAgICAgICAgICBzdGFydCA9IHN0YXJ0X3NlZ25vICsgU0VHU19QRVJfU0VDKHNi
aSk7Cj4gICAgICAgICAgICAgICAgIGlmIChzdGFydCA8IGVuZCkKPiAgICAgICAgICAgICAgICAg
ICAgICAgICBnb3RvIG5leHQ7Cj4gICAgICAgICAgICAgICAgIGVsc2UKPiBAQCAtMjIxMiw3ICsy
MjEyLDcgQEAgdm9pZCBmMmZzX2NsZWFyX3ByZWZyZWVfc2VnbWVudHMoc3RydWN0IGYyZnNfc2Jf
aW5mbyAqc2JpLAo+ICBmaW5kX25leHQ6Cj4gICAgICAgICAgICAgICAgIGlmIChpc192YWxpZCkg
ewo+ICAgICAgICAgICAgICAgICAgICAgICAgIG5leHRfcG9zID0gZmluZF9uZXh0X3plcm9fYml0
X2xlKGVudHJ5LT5kaXNjYXJkX21hcCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgc2JpLT5ibG9ja3NfcGVyX3NlZywgY3VyX3Bvcyk7Cj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQkxLU19QRVJfU0VHKHNiaSksIGN1cl9w
b3MpOwo+ICAgICAgICAgICAgICAgICAgICAgICAgIGxlbiA9IG5leHRfcG9zIC0gY3VyX3BvczsK
Pgo+ICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmMmZzX3NiX2hhc19ibGt6b25lZChzYmkp
IHx8Cj4gQEAgLTIyMjQsMTMgKzIyMjQsMTMgQEAgdm9pZCBmMmZzX2NsZWFyX3ByZWZyZWVfc2Vn
bWVudHMoc3RydWN0IGYyZnNfc2JfaW5mbyAqc2JpLAo+ICAgICAgICAgICAgICAgICAgICAgICAg
IHRvdGFsX2xlbiArPSBsZW47Cj4gICAgICAgICAgICAgICAgIH0gZWxzZSB7Cj4gICAgICAgICAg
ICAgICAgICAgICAgICAgbmV4dF9wb3MgPSBmaW5kX25leHRfYml0X2xlKGVudHJ5LT5kaXNjYXJk
X21hcCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2JpLT5ibG9j
a3NfcGVyX3NlZywgY3VyX3Bvcyk7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgQkxLU19QRVJfU0VHKHNiaSksIGN1cl9wb3MpOwo+ICAgICAgICAgICAg
ICAgICB9Cj4gIHNraXA6Cj4gICAgICAgICAgICAgICAgIGN1cl9wb3MgPSBuZXh0X3BvczsKPiAg
ICAgICAgICAgICAgICAgaXNfdmFsaWQgPSAhaXNfdmFsaWQ7Cj4KPiAtICAgICAgICAgICAgICAg
aWYgKGN1cl9wb3MgPCBzYmktPmJsb2Nrc19wZXJfc2VnKQo+ICsgICAgICAgICAgICAgICBpZiAo
Y3VyX3BvcyA8IEJMS1NfUEVSX1NFRyhzYmkpKQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGdv
dG8gZmluZF9uZXh0Owo+Cj4gICAgICAgICAgICAgICAgIHJlbGVhc2VfZGlzY2FyZF9hZGRyKGVu
dHJ5KTsKPiBAQCAtMjI3OSw3ICsyMjc5LDcgQEAgc3RhdGljIGludCBjcmVhdGVfZGlzY2FyZF9j
bWRfY29udHJvbChzdHJ1Y3QgZjJmc19zYl9pbmZvICpzYmkpCj4gICAgICAgICBkY2MtPm1heF9v
cmRlcmVkX2Rpc2NhcmQgPSBERUZBVUxUX01BWF9PUkRFUkVEX0RJU0NBUkRfR1JBTlVMQVJJVFk7
Cj4gICAgICAgICBkY2MtPmRpc2NhcmRfaW9fYXdhcmUgPSBEUE9MSUNZX0lPX0FXQVJFX0VOQUJM
RTsKPiAgICAgICAgIGlmIChGMkZTX09QVElPTihzYmkpLmRpc2NhcmRfdW5pdCA9PSBESVNDQVJE
X1VOSVRfU0VHTUVOVCkKPiAtICAgICAgICAgICAgICAgZGNjLT5kaXNjYXJkX2dyYW51bGFyaXR5
ID0gc2JpLT5ibG9ja3NfcGVyX3NlZzsKPiArICAgICAgICAgICAgICAgZGNjLT5kaXNjYXJkX2dy
YW51bGFyaXR5ID0gQkxLU19QRVJfU0VHKHNiaSk7Cj4gICAgICAgICBlbHNlIGlmIChGMkZTX09Q
VElPTihzYmkpLmRpc2NhcmRfdW5pdCA9PSBESVNDQVJEX1VOSVRfU0VDVElPTikKPiAgICAgICAg
ICAgICAgICAgZGNjLT5kaXNjYXJkX2dyYW51bGFyaXR5ID0gQkxLU19QRVJfU0VDKHNiaSk7Cj4K
PiBAQCAtMjU0Miw3ICsyNTQyLDcgQEAgc3RhdGljIHVuc2lnbmVkIHNob3J0IGYyZnNfY3Vyc2Vn
X3ZhbGlkX2Jsb2NrcyhzdHJ1Y3QgZjJmc19zYl9pbmZvICpzYmksIGludCB0eXAKPiAgICAgICAg
IHN0cnVjdCBjdXJzZWdfaW5mbyAqY3Vyc2VnID0gQ1VSU0VHX0koc2JpLCB0eXBlKTsKPgo+ICAg
ICAgICAgaWYgKHNiaS0+Y2twdC0+YWxsb2NfdHlwZVt0eXBlXSA9PSBTU1IpCj4gLSAgICAgICAg
ICAgICAgIHJldHVybiBzYmktPmJsb2Nrc19wZXJfc2VnOwo+ICsgICAgICAgICAgICAgICByZXR1
cm4gQkxLU19QRVJfU0VHKHNiaSk7Cj4gICAgICAgICByZXR1cm4gY3Vyc2VnLT5uZXh0X2Jsa29m
ZjsKPiAgfQo+Cj4gQEAgLTI2MzAsNyArMjYzMCw3IEBAIHN0YXRpYyBpbnQgaXNfbmV4dF9zZWdt
ZW50X2ZyZWUoc3RydWN0IGYyZnNfc2JfaW5mbyAqc2JpLAo+ICAgICAgICAgdW5zaWduZWQgaW50
IHNlZ25vID0gY3Vyc2VnLT5zZWdubyArIDE7Cj4gICAgICAgICBzdHJ1Y3QgZnJlZV9zZWdtYXBf
aW5mbyAqZnJlZV9pID0gRlJFRV9JKHNiaSk7Cj4KPiAtICAgICAgIGlmIChzZWdubyA8IE1BSU5f
U0VHUyhzYmkpICYmIHNlZ25vICUgc2JpLT5zZWdzX3Blcl9zZWMpCj4gKyAgICAgICBpZiAoc2Vn
bm8gPCBNQUlOX1NFR1Moc2JpKSAmJiBzZWdubyAlIFNFR1NfUEVSX1NFQyhzYmkpKQo+ICAgICAg
ICAgICAgICAgICByZXR1cm4gIXRlc3RfYml0KHNlZ25vLCBmcmVlX2ktPmZyZWVfc2VnbWFwKTsK
PiAgICAgICAgIHJldHVybiAwOwo+ICB9Cj4gQEAgLTI2NTQsNyArMjY1NCw3IEBAIHN0YXRpYyB2
b2lkIGdldF9uZXdfc2VnbWVudChzdHJ1Y3QgZjJmc19zYl9pbmZvICpzYmksCj4KPiAgICAgICAg
IHNwaW5fbG9jaygmZnJlZV9pLT5zZWdtYXBfbG9jayk7Cj4KPiAtICAgICAgIGlmICghbmV3X3Nl
YyAmJiAoKCpuZXdzZWcgKyAxKSAlIHNiaS0+c2Vnc19wZXJfc2VjKSkgewo+ICsgICAgICAgaWYg
KCFuZXdfc2VjICYmICgoKm5ld3NlZyArIDEpICUgU0VHU19QRVJfU0VDKHNiaSkpKSB7Cj4gICAg
ICAgICAgICAgICAgIHNlZ25vID0gZmluZF9uZXh0X3plcm9fYml0KGZyZWVfaS0+ZnJlZV9zZWdt
YXAsCj4gICAgICAgICAgICAgICAgICAgICAgICAgR0VUX1NFR19GUk9NX1NFQyhzYmksIGhpbnQg
KyAxKSwgKm5ld3NlZyArIDEpOwo+ICAgICAgICAgICAgICAgICBpZiAoc2Vnbm8gPCBHRVRfU0VH
X0ZST01fU0VDKHNiaSwgaGludCArIDEpKQo+IEBAIC0yNzU3LDcgKzI3NTcsNyBAQCBzdGF0aWMg
dW5zaWduZWQgaW50IF9fZ2V0X25leHRfc2Vnbm8oc3RydWN0IGYyZnNfc2JfaW5mbyAqc2JpLCBp
bnQgdHlwZSkKPgo+ICAgICAgICAgc2FuaXR5X2NoZWNrX3NlZ190eXBlKHNiaSwgc2VnX3R5cGUp
Owo+ICAgICAgICAgaWYgKGYyZnNfbmVlZF9yYW5kX3NlZyhzYmkpKQo+IC0gICAgICAgICAgICAg
ICByZXR1cm4gZ2V0X3JhbmRvbV91MzJfYmVsb3coTUFJTl9TRUNTKHNiaSkgKiBzYmktPnNlZ3Nf
cGVyX3NlYyk7Cj4gKyAgICAgICAgICAgICAgIHJldHVybiBnZXRfcmFuZG9tX3UzMl9iZWxvdyhN
QUlOX1NFQ1Moc2JpKSAqIFNFR1NfUEVSX1NFQyhzYmkpKTsKPgo+ICAgICAgICAgLyogaWYgc2Vn
c19wZXJfc2VjIGlzIGxhcmdlIHRoYW4gMSwgd2UgbmVlZCB0byBrZWVwIG9yaWdpbmFsIHBvbGlj
eS4gKi8KPiAgICAgICAgIGlmIChfX2lzX2xhcmdlX3NlY3Rpb24oc2JpKSkKPiBAQCAtMjgyNyw3
ICsyODI3LDcgQEAgc3RhdGljIGludCBfX25leHRfZnJlZV9ibGtvZmYoc3RydWN0IGYyZnNfc2Jf
aW5mbyAqc2JpLAo+ICAgICAgICAgZm9yIChpID0gMDsgaSA8IGVudHJpZXM7IGkrKykKPiAgICAg
ICAgICAgICAgICAgdGFyZ2V0X21hcFtpXSA9IGNrcHRfbWFwW2ldIHwgY3VyX21hcFtpXTsKPgo+
IC0gICAgICAgcmV0dXJuIF9fZmluZF9yZXZfbmV4dF96ZXJvX2JpdCh0YXJnZXRfbWFwLCBzYmkt
PmJsb2Nrc19wZXJfc2VnLCBzdGFydCk7Cj4gKyAgICAgICByZXR1cm4gX19maW5kX3Jldl9uZXh0
X3plcm9fYml0KHRhcmdldF9tYXAsIEJMS1NfUEVSX1NFRyhzYmkpLCBzdGFydCk7Cj4gIH0KPgo+
ICBzdGF0aWMgaW50IGYyZnNfZmluZF9uZXh0X3Nzcl9ibG9jayhzdHJ1Y3QgZjJmc19zYl9pbmZv
ICpzYmksCj4gQEAgLTI4MzgsNyArMjgzOCw3IEBAIHN0YXRpYyBpbnQgZjJmc19maW5kX25leHRf
c3NyX2Jsb2NrKHN0cnVjdCBmMmZzX3NiX2luZm8gKnNiaSwKPgo+ICBib29sIGYyZnNfc2VnbWVu
dF9oYXNfZnJlZV9zbG90KHN0cnVjdCBmMmZzX3NiX2luZm8gKnNiaSwgaW50IHNlZ25vKQo+ICB7
Cj4gLSAgICAgICByZXR1cm4gX19uZXh0X2ZyZWVfYmxrb2ZmKHNiaSwgc2Vnbm8sIDApIDwgc2Jp
LT5ibG9ja3NfcGVyX3NlZzsKPiArICAgICAgIHJldHVybiBfX25leHRfZnJlZV9ibGtvZmYoc2Jp
LCBzZWdubywgMCkgPCBCTEtTX1BFUl9TRUcoc2JpKTsKPiAgfQo+Cj4gIC8qCj4gQEAgLTMyMzgs
OCArMzIzOCw4IEBAIGludCBmMmZzX3RyaW1fZnMoc3RydWN0IGYyZnNfc2JfaW5mbyAqc2JpLCBz
dHJ1Y3QgZnN0cmltX3JhbmdlICpyYW5nZSkKPiAgICAgICAgIGVuZF9zZWdubyA9IChlbmQgPj0g
TUFYX0JMS0FERFIoc2JpKSkgPyBNQUlOX1NFR1Moc2JpKSAtIDEgOgo+ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdFVF9TRUdOTyhzYmksIGVuZCk7Cj4g
ICAgICAgICBpZiAobmVlZF9hbGlnbikgewo+IC0gICAgICAgICAgICAgICBzdGFydF9zZWdubyA9
IHJvdW5kZG93bihzdGFydF9zZWdubywgc2JpLT5zZWdzX3Blcl9zZWMpOwo+IC0gICAgICAgICAg
ICAgICBlbmRfc2Vnbm8gPSByb3VuZHVwKGVuZF9zZWdubyArIDEsIHNiaS0+c2Vnc19wZXJfc2Vj
KSAtIDE7Cj4gKyAgICAgICAgICAgICAgIHN0YXJ0X3NlZ25vID0gcm91bmRkb3duKHN0YXJ0X3Nl
Z25vLCBTRUdTX1BFUl9TRUMoc2JpKSk7Cj4gKyAgICAgICAgICAgICAgIGVuZF9zZWdubyA9IHJv
dW5kdXAoZW5kX3NlZ25vICsgMSwgU0VHU19QRVJfU0VDKHNiaSkpIC0gMTsKPiAgICAgICAgIH0K
Pgo+ICAgICAgICAgY3BjLnJlYXNvbiA9IENQX0RJU0NBUkQ7Cj4gQEAgLTM0MzcsNyArMzQzNyw3
IEBAIHZvaWQgZjJmc19hbGxvY2F0ZV9kYXRhX2Jsb2NrKHN0cnVjdCBmMmZzX3NiX2luZm8gKnNi
aSwgc3RydWN0IHBhZ2UgKnBhZ2UsCj4gICAgICAgICB9Cj4gICAgICAgICAqbmV3X2Jsa2FkZHIg
PSBORVhUX0ZSRUVfQkxLQUREUihzYmksIGN1cnNlZyk7Cj4KPiAtICAgICAgIGYyZnNfYnVnX29u
KHNiaSwgY3Vyc2VnLT5uZXh0X2Jsa29mZiA+PSBzYmktPmJsb2Nrc19wZXJfc2VnKTsKPiArICAg
ICAgIGYyZnNfYnVnX29uKHNiaSwgY3Vyc2VnLT5uZXh0X2Jsa29mZiA+PSBCTEtTX1BFUl9TRUco
c2JpKSk7Cj4KPiAgICAgICAgIGYyZnNfd2FpdF9kaXNjYXJkX2JpbyhzYmksICpuZXdfYmxrYWRk
cik7Cj4KPiBAQCAtMzg4MSw3ICszODgxLDcgQEAgc3RhdGljIGludCByZWFkX2NvbXBhY3RlZF9z
dW1tYXJpZXMoc3RydWN0IGYyZnNfc2JfaW5mbyAqc2JpKQo+ICAgICAgICAgICAgICAgICBzZWdf
aS0+bmV4dF9ibGtvZmYgPSBibGtfb2ZmOwo+Cj4gICAgICAgICAgICAgICAgIGlmIChzZWdfaS0+
YWxsb2NfdHlwZSA9PSBTU1IpCj4gLSAgICAgICAgICAgICAgICAgICAgICAgYmxrX29mZiA9IHNi
aS0+YmxvY2tzX3Blcl9zZWc7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgYmxrX29mZiA9IEJM
S1NfUEVSX1NFRyhzYmkpOwo+Cj4gICAgICAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBibGtf
b2ZmOyBqKyspIHsKPiAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgZjJmc19zdW1tYXJ5
ICpzOwo+IEBAIC0zOTQ5LDcgKzM5NDksNyBAQCBzdGF0aWMgaW50IHJlYWRfbm9ybWFsX3N1bW1h
cmllcyhzdHJ1Y3QgZjJmc19zYl9pbmZvICpzYmksIGludCB0eXBlKQo+ICAgICAgICAgICAgICAg
ICAgICAgICAgIHN0cnVjdCBmMmZzX3N1bW1hcnkgKm5zID0gJnN1bS0+ZW50cmllc1swXTsKPiAg
ICAgICAgICAgICAgICAgICAgICAgICBpbnQgaTsKPgo+IC0gICAgICAgICAgICAgICAgICAgICAg
IGZvciAoaSA9IDA7IGkgPCBzYmktPmJsb2Nrc19wZXJfc2VnOyBpKyssIG5zKyspIHsKPiArICAg
ICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgQkxLU19QRVJfU0VHKHNiaSk7IGkr
KywgbnMrKykgewo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnMtPnZlcnNpb24g
PSAwOwo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnMtPm9mc19pbl9ub2RlID0g
MDsKPiAgICAgICAgICAgICAgICAgICAgICAgICB9Cj4gQEAgLTQ1ODIsMjEgKzQ1ODIsMjAgQEAg
c3RhdGljIGludCBidWlsZF9zaXRfZW50cmllcyhzdHJ1Y3QgZjJmc19zYl9pbmZvICpzYmkpCj4K
PiAgICAgICAgICAgICAgICAgICAgICAgICBzaXRfdmFsaWRfYmxvY2tzW1NFX1BBR0VUWVBFKHNl
KV0gKz0gc2UtPnZhbGlkX2Jsb2NrczsKPgo+IC0gICAgICAgICAgICAgICAgICAgICAgIGlmIChm
MmZzX2Jsb2NrX3VuaXRfZGlzY2FyZChzYmkpKSB7Cj4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAvKiBidWlsZCBkaXNjYXJkIG1hcCBvbmx5IG9uZSB0aW1lICovCj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNfc2V0X2NrcHRfZmxhZ3Moc2JpLCBDUF9UUklN
TUVEX0ZMQUcpKSB7Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1l
bXNldChzZS0+ZGlzY2FyZF9tYXAsIDB4ZmYsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYg
KCFmMmZzX2Jsb2NrX3VuaXRfZGlzY2FyZChzYmkpKQo+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgZ290byBpbml0X2Rpc2NhcmRfbWFwX2RvbmU7Cj4gKwo+ICsgICAgICAgICAgICAg
ICAgICAgICAgIC8qIGJ1aWxkIGRpc2NhcmQgbWFwIG9ubHkgb25lIHRpbWUgKi8KPiArICAgICAg
ICAgICAgICAgICAgICAgICBpZiAoaXNfc2V0X2NrcHRfZmxhZ3Moc2JpLCBDUF9UUklNTUVEX0ZM
QUcpKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW1zZXQoc2UtPmRpc2Nh
cmRfbWFwLCAweGZmLAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIFNJVF9WQkxPQ0tfTUFQX1NJWkUpOwo+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgfSBlbHNlIHsKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
bWVtY3B5KHNlLT5kaXNjYXJkX21hcCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzZS0+Y3VyX3ZhbGlkX21hcCwKPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGdvdG8gaW5pdF9kaXNjYXJkX21hcF9kb25lOwo+ICsgICAgICAgICAgICAg
ICAgICAgICAgIH0KPiArICAgICAgICAgICAgICAgICAgICAgICBtZW1jcHkoc2UtPmRpc2NhcmRf
bWFwLCBzZS0+Y3VyX3ZhbGlkX21hcCwKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBTSVRfVkJMT0NLX01BUF9TSVpFKTsKPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgc2JpLT5kaXNjYXJkX2Jsa3MgKz0KPiAtICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYmktPmJsb2Nrc19wZXJfc2Vn
IC0KPiArICAgICAgICAgICAgICAgICAgICAgICBzYmktPmRpc2NhcmRfYmxrcyArPSBCTEtTX1BF
Ul9TRUcoc2JpKSAtCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgc2UtPnZhbGlkX2Jsb2NrczsKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IH0KPiAtICAgICAgICAgICAgICAgICAgICAgICB9Cj4gLQo+ICtpbml0X2Rpc2NhcmRfbWFwX2Rv
bmU6Cj4gICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9faXNfbGFyZ2Vfc2VjdGlvbihzYmkp
KQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0X3NlY19lbnRyeShzYmksIHN0
YXJ0KS0+dmFsaWRfYmxvY2tzICs9Cj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBzZS0+dmFsaWRfYmxvY2tzOwo+IEBAIC00NzM2LDcgKzQ3
MzUsNyBAQCBzdGF0aWMgdm9pZCBpbml0X2RpcnR5X3NlZ21hcChzdHJ1Y3QgZjJmc19zYl9pbmZv
ICpzYmkpCj4gICAgICAgICAgICAgICAgIHJldHVybjsKPgo+ICAgICAgICAgbXV0ZXhfbG9jaygm
ZGlydHlfaS0+c2VnbGlzdF9sb2NrKTsKPiAtICAgICAgIGZvciAoc2Vnbm8gPSAwOyBzZWdubyA8
IE1BSU5fU0VHUyhzYmkpOyBzZWdubyArPSBzYmktPnNlZ3NfcGVyX3NlYykgewo+ICsgICAgICAg
Zm9yIChzZWdubyA9IDA7IHNlZ25vIDwgTUFJTl9TRUdTKHNiaSk7IHNlZ25vICs9IFNFR1NfUEVS
X1NFQyhzYmkpKSB7Cj4gICAgICAgICAgICAgICAgIHZhbGlkX2Jsb2NrcyA9IGdldF92YWxpZF9i
bG9ja3Moc2JpLCBzZWdubywgdHJ1ZSk7Cj4gICAgICAgICAgICAgICAgIHNlY25vID0gR0VUX1NF
Q19GUk9NX1NFRyhzYmksIHNlZ25vKTsKPgo+IEBAIC00ODM1LDcgKzQ4MzQsNyBAQCBzdGF0aWMg
aW50IHNhbml0eV9jaGVja19jdXJzZWcoc3RydWN0IGYyZnNfc2JfaW5mbyAqc2JpKQo+ICAgICAg
ICAgICAgICAgICBpZiAoY3Vyc2VnLT5hbGxvY190eXBlID09IFNTUikKPiAgICAgICAgICAgICAg
ICAgICAgICAgICBjb250aW51ZTsKPgo+IC0gICAgICAgICAgICAgICBmb3IgKGJsa29mcyArPSAx
OyBibGtvZnMgPCBzYmktPmJsb2Nrc19wZXJfc2VnOyBibGtvZnMrKykgewo+ICsgICAgICAgICAg
ICAgICBmb3IgKGJsa29mcyArPSAxOyBibGtvZnMgPCBCTEtTX1BFUl9TRUcoc2JpKTsgYmxrb2Zz
KyspIHsKPiAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWYyZnNfdGVzdF9iaXQoYmxrb2Zz
LCBzZS0+Y3VyX3ZhbGlkX21hcCkpCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBj
b250aW51ZTsKPiAgb3V0Ogo+IEBAIC01MTE0LDcgKzUxMTMsNyBAQCBzdGF0aWMgaW5saW5lIHVu
c2lnbmVkIGludCBmMmZzX3VzYWJsZV96b25lX2Jsa3NfaW5fc2VnKAo+ICAgICAgICAgdW5zaWdu
ZWQgaW50IHNlY25vOwo+Cj4gICAgICAgICBpZiAoIXNiaS0+dW51c2FibGVfYmxvY2tzX3Blcl9z
ZWMpCj4gLSAgICAgICAgICAgICAgIHJldHVybiBzYmktPmJsb2Nrc19wZXJfc2VnOwo+ICsgICAg
ICAgICAgICAgICByZXR1cm4gQkxLU19QRVJfU0VHKHNiaSk7Cj4KPiAgICAgICAgIHNlY25vID0g
R0VUX1NFQ19GUk9NX1NFRyhzYmksIHNlZ25vKTsKPiAgICAgICAgIHNlZ19zdGFydCA9IFNUQVJU
X0JMT0NLKHNiaSwgc2Vnbm8pOwo+IEBAIC01MTI5LDEwICs1MTI4LDEwIEBAIHN0YXRpYyBpbmxp
bmUgdW5zaWduZWQgaW50IGYyZnNfdXNhYmxlX3pvbmVfYmxrc19pbl9zZWcoCj4gICAgICAgICAg
Ki8KPiAgICAgICAgIGlmIChzZWdfc3RhcnQgPj0gc2VjX2NhcF9ibGthZGRyKQo+ICAgICAgICAg
ICAgICAgICByZXR1cm4gMDsKPiAtICAgICAgIGlmIChzZWdfc3RhcnQgKyBzYmktPmJsb2Nrc19w
ZXJfc2VnID4gc2VjX2NhcF9ibGthZGRyKQo+ICsgICAgICAgaWYgKHNlZ19zdGFydCArIEJMS1Nf
UEVSX1NFRyhzYmkpID4gc2VjX2NhcF9ibGthZGRyKQo+ICAgICAgICAgICAgICAgICByZXR1cm4g
c2VjX2NhcF9ibGthZGRyIC0gc2VnX3N0YXJ0Owo+Cj4gLSAgICAgICByZXR1cm4gc2JpLT5ibG9j
a3NfcGVyX3NlZzsKPiArICAgICAgIHJldHVybiBCTEtTX1BFUl9TRUcoc2JpKTsKPiAgfQo+ICAj
ZWxzZQo+ICBpbnQgZjJmc19maXhfY3Vyc2VnX3dyaXRlX3BvaW50ZXIoc3RydWN0IGYyZnNfc2Jf
aW5mbyAqc2JpKQo+IEBAIC01MTU4LDcgKzUxNTcsNyBAQCB1bnNpZ25lZCBpbnQgZjJmc191c2Fi
bGVfYmxrc19pbl9zZWcoc3RydWN0IGYyZnNfc2JfaW5mbyAqc2JpLAo+ICAgICAgICAgaWYgKGYy
ZnNfc2JfaGFzX2Jsa3pvbmVkKHNiaSkpCj4gICAgICAgICAgICAgICAgIHJldHVybiBmMmZzX3Vz
YWJsZV96b25lX2Jsa3NfaW5fc2VnKHNiaSwgc2Vnbm8pOwo+Cj4gLSAgICAgICByZXR1cm4gc2Jp
LT5ibG9ja3NfcGVyX3NlZzsKPiArICAgICAgIHJldHVybiBCTEtTX1BFUl9TRUcoc2JpKTsKPiAg
fQo+Cj4gIHVuc2lnbmVkIGludCBmMmZzX3VzYWJsZV9zZWdzX2luX3NlYyhzdHJ1Y3QgZjJmc19z
Yl9pbmZvICpzYmksCj4gQEAgLTUxNjcsNyArNTE2Niw3IEBAIHVuc2lnbmVkIGludCBmMmZzX3Vz
YWJsZV9zZWdzX2luX3NlYyhzdHJ1Y3QgZjJmc19zYl9pbmZvICpzYmksCj4gICAgICAgICBpZiAo
ZjJmc19zYl9oYXNfYmxrem9uZWQoc2JpKSkKPiAgICAgICAgICAgICAgICAgcmV0dXJuIENBUF9T
RUdTX1BFUl9TRUMoc2JpKTsKPgo+IC0gICAgICAgcmV0dXJuIHNiaS0+c2Vnc19wZXJfc2VjOwo+
ICsgICAgICAgcmV0dXJuIFNFR1NfUEVSX1NFQyhzYmkpOwo+ICB9Cj4KPiAgLyoKPiBAQCAtNTE4
MiwxNCArNTE4MSwxNCBAQCBzdGF0aWMgdm9pZCBpbml0X21pbl9tYXhfbXRpbWUoc3RydWN0IGYy
ZnNfc2JfaW5mbyAqc2JpKQo+Cj4gICAgICAgICBzaXRfaS0+bWluX210aW1lID0gVUxMT05HX01B
WDsKPgo+IC0gICAgICAgZm9yIChzZWdubyA9IDA7IHNlZ25vIDwgTUFJTl9TRUdTKHNiaSk7IHNl
Z25vICs9IHNiaS0+c2Vnc19wZXJfc2VjKSB7Cj4gKyAgICAgICBmb3IgKHNlZ25vID0gMDsgc2Vn
bm8gPCBNQUlOX1NFR1Moc2JpKTsgc2Vnbm8gKz0gU0VHU19QRVJfU0VDKHNiaSkpIHsKPiAgICAg
ICAgICAgICAgICAgdW5zaWduZWQgaW50IGk7Cj4gICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxv
bmcgbG9uZyBtdGltZSA9IDA7Cj4KPiAtICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHNi
aS0+c2Vnc19wZXJfc2VjOyBpKyspCj4gKyAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBT
RUdTX1BFUl9TRUMoc2JpKTsgaSsrKQo+ICAgICAgICAgICAgICAgICAgICAgICAgIG10aW1lICs9
IGdldF9zZWdfZW50cnkoc2JpLCBzZWdubyArIGkpLT5tdGltZTsKPgo+IC0gICAgICAgICAgICAg
ICBtdGltZSA9IGRpdl91NjQobXRpbWUsIHNiaS0+c2Vnc19wZXJfc2VjKTsKPiArICAgICAgICAg
ICAgICAgbXRpbWUgPSBkaXZfdTY0KG10aW1lLCBTRUdTX1BFUl9TRUMoc2JpKSk7Cj4KPiAgICAg
ICAgICAgICAgICAgaWYgKHNpdF9pLT5taW5fbXRpbWUgPiBtdGltZSkKPiAgICAgICAgICAgICAg
ICAgICAgICAgICBzaXRfaS0+bWluX210aW1lID0gbXRpbWU7Cj4gQEAgLTUyMjgsNyArNTIyNyw3
IEBAIGludCBmMmZzX2J1aWxkX3NlZ21lbnRfbWFuYWdlcihzdHJ1Y3QgZjJmc19zYl9pbmZvICpz
YmkpCj4gICAgICAgICAgICAgICAgIHNtX2luZm8tPmlwdV9wb2xpY3kgPSBCSVQoRjJGU19JUFVf
RlNZTkMpOwo+ICAgICAgICAgc21faW5mby0+bWluX2lwdV91dGlsID0gREVGX01JTl9JUFVfVVRJ
TDsKPiAgICAgICAgIHNtX2luZm8tPm1pbl9mc3luY19ibG9ja3MgPSBERUZfTUlOX0ZTWU5DX0JM
T0NLUzsKPiAtICAgICAgIHNtX2luZm8tPm1pbl9zZXFfYmxvY2tzID0gc2JpLT5ibG9ja3NfcGVy
X3NlZzsKPiArICAgICAgIHNtX2luZm8tPm1pbl9zZXFfYmxvY2tzID0gQkxLU19QRVJfU0VHKHNi
aSk7Cj4gICAgICAgICBzbV9pbmZvLT5taW5faG90X2Jsb2NrcyA9IERFRl9NSU5fSE9UX0JMT0NL
UzsKPiAgICAgICAgIHNtX2luZm8tPm1pbl9zc3Jfc2VjdGlvbnMgPSByZXNlcnZlZF9zZWN0aW9u
cyhzYmkpOwo+Cj4gZGlmZiAtLWdpdCBhL2ZzL2YyZnMvc2VnbWVudC5oIGIvZnMvZjJmcy9zZWdt
ZW50LmgKPiBpbmRleCA4MTI5YmU3ODhiZDUuLjk2Y2VjODMwMTJmMSAxMDA2NDQKPiAtLS0gYS9m
cy9mMmZzL3NlZ21lbnQuaAo+ICsrKyBiL2ZzL2YyZnMvc2VnbWVudC5oCj4gQEAgLTk5LDggKzk5
LDYgQEAgc3RhdGljIGlubGluZSB2b2lkIHNhbml0eV9jaGVja19zZWdfdHlwZShzdHJ1Y3QgZjJm
c19zYl9pbmZvICpzYmksCj4gICAgICAgICAoKCFfX2lzX3ZhbGlkX2RhdGFfYmxrYWRkcihibGtf
YWRkcikpID8gICAgICAgICAgICAgICAgIFwKPiAgICAgICAgIE5VTExfU0VHTk8gOiBHRVRfTDJS
X1NFR05PKEZSRUVfSShzYmkpLCAgICAgICAgICAgICAgICAgXAo+ICAgICAgICAgICAgICAgICBH
RVRfU0VHTk9fRlJPTV9TRUcwKHNiaSwgYmxrX2FkZHIpKSkKPiAtI2RlZmluZSBCTEtTX1BFUl9T
RUMoc2JpKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAo+IC0gICAgICAg
KChzYmkpLT5zZWdzX3Blcl9zZWMgKiAoc2JpKS0+YmxvY2tzX3Blcl9zZWcpCj4gICNkZWZpbmUg
Q0FQX0JMS1NfUEVSX1NFQyhzYmkpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
PiAgICAgICAgICgoc2JpKS0+c2Vnc19wZXJfc2VjICogKHNiaSktPmJsb2Nrc19wZXJfc2VnIC0g
ICAgICAgICAgXAo+ICAgICAgICAgIChzYmkpLT51bnVzYWJsZV9ibG9ja3NfcGVyX3NlYykKPiBA
QCAtMzY0LDcgKzM2Miw3IEBAIHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgaW50IGdldF9ja3B0X3Zh
bGlkX2Jsb2NrcyhzdHJ1Y3QgZjJmc19zYl9pbmZvICpzYmksCj4gICAgICAgICAgICAgICAgIHVu
c2lnbmVkIGludCBibG9ja3MgPSAwOwo+ICAgICAgICAgICAgICAgICBpbnQgaTsKPgo+IC0gICAg
ICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc2JpLT5zZWdzX3Blcl9zZWM7IGkrKywgc3RhcnRf
c2Vnbm8rKykgewo+ICsgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgU0VHU19QRVJfU0VD
KHNiaSk7IGkrKywgc3RhcnRfc2Vnbm8rKykgewo+ICAgICAgICAgICAgICAgICAgICAgICAgIHN0
cnVjdCBzZWdfZW50cnkgKnNlID0gZ2V0X3NlZ19lbnRyeShzYmksIHN0YXJ0X3NlZ25vKTsKPgo+
ICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrcyArPSBzZS0+Y2twdF92YWxpZF9ibG9ja3M7
Cj4gQEAgLTQ0OSw3ICs0NDcsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgX19zZXRfZnJlZShzdHJ1
Y3QgZjJmc19zYl9pbmZvICpzYmksIHVuc2lnbmVkIGludCBzZWdubykKPiAgICAgICAgIGZyZWVf
aS0+ZnJlZV9zZWdtZW50cysrOwo+Cj4gICAgICAgICBuZXh0ID0gZmluZF9uZXh0X2JpdChmcmVl
X2ktPmZyZWVfc2VnbWFwLAo+IC0gICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0X3NlZ25vICsg
c2JpLT5zZWdzX3Blcl9zZWMsIHN0YXJ0X3NlZ25vKTsKPiArICAgICAgICAgICAgICAgICAgICAg
ICBzdGFydF9zZWdubyArIFNFR1NfUEVSX1NFQyhzYmkpLCBzdGFydF9zZWdubyk7Cj4gICAgICAg
ICBpZiAobmV4dCA+PSBzdGFydF9zZWdubyArIHVzYWJsZV9zZWdzKSB7Cj4gICAgICAgICAgICAg
ICAgIGNsZWFyX2JpdChzZWNubywgZnJlZV9pLT5mcmVlX3NlY21hcCk7Cj4gICAgICAgICAgICAg
ICAgIGZyZWVfaS0+ZnJlZV9zZWN0aW9ucysrOwo+IEBAIC00ODUsNyArNDgzLDcgQEAgc3RhdGlj
IGlubGluZSB2b2lkIF9fc2V0X3Rlc3RfYW5kX2ZyZWUoc3RydWN0IGYyZnNfc2JfaW5mbyAqc2Jp
LAo+ICAgICAgICAgICAgICAgICBpZiAoIWlubWVtICYmIElTX0NVUlNFQyhzYmksIHNlY25vKSkK
PiAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIHNraXBfZnJlZTsKPiAgICAgICAgICAgICAg
ICAgbmV4dCA9IGZpbmRfbmV4dF9iaXQoZnJlZV9pLT5mcmVlX3NlZ21hcCwKPiAtICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0X3NlZ25vICsgc2JpLT5zZWdzX3Blcl9zZWMsIHN0
YXJ0X3NlZ25vKTsKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0X3NlZ25v
ICsgU0VHU19QRVJfU0VDKHNiaSksIHN0YXJ0X3NlZ25vKTsKPiAgICAgICAgICAgICAgICAgaWYg
KG5leHQgPj0gc3RhcnRfc2Vnbm8gKyB1c2FibGVfc2Vncykgewo+ICAgICAgICAgICAgICAgICAg
ICAgICAgIGlmICh0ZXN0X2FuZF9jbGVhcl9iaXQoc2Vjbm8sIGZyZWVfaS0+ZnJlZV9zZWNtYXAp
KQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJlZV9pLT5mcmVlX3NlY3Rpb25z
Kys7Cj4gQEAgLTc5MywxMCArNzkxLDEwIEBAIHN0YXRpYyBpbmxpbmUgaW50IGNoZWNrX2Jsb2Nr
X2NvdW50KHN0cnVjdCBmMmZzX3NiX2luZm8gKnNiaSwKPiAgICAgICAgICAgICAgICAgcmV0dXJu
IC1FRlNDT1JSVVBURUQ7Cj4gICAgICAgICB9Cj4KPiAtICAgICAgIGlmICh1c2FibGVfYmxrc19w
ZXJfc2VnIDwgc2JpLT5ibG9ja3NfcGVyX3NlZykKPiArICAgICAgIGlmICh1c2FibGVfYmxrc19w
ZXJfc2VnIDwgQkxLU19QRVJfU0VHKHNiaSkpCj4gICAgICAgICAgICAgICAgIGYyZnNfYnVnX29u
KHNiaSwgZmluZF9uZXh0X2JpdF9sZSgmcmF3X3NpdC0+dmFsaWRfbWFwLAo+IC0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc2JpLT5ibG9ja3NfcGVyX3NlZywKPiAtICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVzYWJsZV9ibGtzX3Blcl9zZWcpICE9IHNiaS0+YmxvY2tzX3Bl
cl9zZWcpOwo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQkxLU19QRVJfU0VHKHNi
aSksCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FibGVfYmxrc19wZXJfc2Vn
KSAhPSBCTEtTX1BFUl9TRUcoc2JpKSk7Cj4KPiAgICAgICAgIC8qIGNoZWNrIHNlZ21lbnQgdXNh
Z2UsIGFuZCBjaGVjayBib3VuZGFyeSBvZiBhIGdpdmVuIHNlZ21lbnQgbnVtYmVyICovCj4gICAg
ICAgICBpZiAodW5saWtlbHkoR0VUX1NJVF9WQkxPQ0tTKHJhd19zaXQpID4gdXNhYmxlX2Jsa3Nf
cGVyX3NlZwo+IEBAIC05MTUsOSArOTEzLDkgQEAgc3RhdGljIGlubGluZSBpbnQgbnJfcGFnZXNf
dG9fc2tpcChzdHJ1Y3QgZjJmc19zYl9pbmZvICpzYmksIGludCB0eXBlKQo+ICAgICAgICAgICAg
ICAgICByZXR1cm4gMDsKPgo+ICAgICAgICAgaWYgKHR5cGUgPT0gREFUQSkKPiAtICAgICAgICAg
ICAgICAgcmV0dXJuIHNiaS0+YmxvY2tzX3Blcl9zZWc7Cj4gKyAgICAgICAgICAgICAgIHJldHVy
biBCTEtTX1BFUl9TRUcoc2JpKTsKPiAgICAgICAgIGVsc2UgaWYgKHR5cGUgPT0gTk9ERSkKPiAt
ICAgICAgICAgICAgICAgcmV0dXJuIDggKiBzYmktPmJsb2Nrc19wZXJfc2VnOwo+ICsgICAgICAg
ICAgICAgICByZXR1cm4gOCAqIEJMS1NfUEVSX1NFRyhzYmkpOwo+ICAgICAgICAgZWxzZSBpZiAo
dHlwZSA9PSBNRVRBKQo+ICAgICAgICAgICAgICAgICByZXR1cm4gOCAqIEJJT19NQVhfVkVDUzsK
PiAgICAgICAgIGVsc2UKPiBkaWZmIC0tZ2l0IGEvZnMvZjJmcy9zdXBlci5jIGIvZnMvZjJmcy9z
dXBlci5jCj4gaW5kZXggZjE1MTZmZDUwODhhLi5jMDY4OGMxMjRhYTcgMTAwNjQ0Cj4gLS0tIGEv
ZnMvZjJmcy9zdXBlci5jCj4gKysrIGIvZnMvZjJmcy9zdXBlci5jCj4gQEAgLTM2NDMsNyArMzY0
Myw3IEBAIGludCBmMmZzX3Nhbml0eV9jaGVja19ja3B0KHN0cnVjdCBmMmZzX3NiX2luZm8gKnNi
aSkKPiAgICAgICAgIH0KPgo+ICAgICAgICAgbWFpbl9zZWdzID0gbGUzMl90b19jcHUocmF3X3N1
cGVyLT5zZWdtZW50X2NvdW50X21haW4pOwo+IC0gICAgICAgYmxvY2tzX3Blcl9zZWcgPSBzYmkt
PmJsb2Nrc19wZXJfc2VnOwo+ICsgICAgICAgYmxvY2tzX3Blcl9zZWcgPSBCTEtTX1BFUl9TRUco
c2JpKTsKPgo+ICAgICAgICAgZm9yIChpID0gMDsgaSA8IE5SX0NVUlNFR19OT0RFX1RZUEU7IGkr
Kykgewo+ICAgICAgICAgICAgICAgICBpZiAobGUzMl90b19jcHUoY2twdC0+Y3VyX25vZGVfc2Vn
bm9baV0pID49IG1haW5fc2VncyB8fAo+IEBAIC0zNzU2LDggKzM3NTYsOCBAQCBzdGF0aWMgdm9p
ZCBpbml0X3NiX2luZm8oc3RydWN0IGYyZnNfc2JfaW5mbyAqc2JpKQo+ICAgICAgICAgc2JpLT5z
ZWNzX3Blcl96b25lID0gbGUzMl90b19jcHUocmF3X3N1cGVyLT5zZWNzX3Blcl96b25lKTsKPiAg
ICAgICAgIHNiaS0+dG90YWxfc2VjdGlvbnMgPSBsZTMyX3RvX2NwdShyYXdfc3VwZXItPnNlY3Rp
b25fY291bnQpOwo+ICAgICAgICAgc2JpLT50b3RhbF9ub2RlX2NvdW50ID0KPiAtICAgICAgICAg
ICAgICAgKGxlMzJfdG9fY3B1KHJhd19zdXBlci0+c2VnbWVudF9jb3VudF9uYXQpIC8gMikKPiAt
ICAgICAgICAgICAgICAgICAgICAgICAqIHNiaS0+YmxvY2tzX3Blcl9zZWcgKiBOQVRfRU5UUllf
UEVSX0JMT0NLOwo+ICsgICAgICAgICAgICAgICAoKGxlMzJfdG9fY3B1KHJhd19zdXBlci0+c2Vn
bWVudF9jb3VudF9uYXQpIC8gMikgKgo+ICsgICAgICAgICAgICAgICBOQVRfRU5UUllfUEVSX0JM
T0NLKSA8PCBzYmktPmxvZ19ibG9ja3NfcGVyX3NlZzsKPiAgICAgICAgIEYyRlNfUk9PVF9JTk8o
c2JpKSA9IGxlMzJfdG9fY3B1KHJhd19zdXBlci0+cm9vdF9pbm8pOwo+ICAgICAgICAgRjJGU19O
T0RFX0lOTyhzYmkpID0gbGUzMl90b19jcHUocmF3X3N1cGVyLT5ub2RlX2lubyk7Cj4gICAgICAg
ICBGMkZTX01FVEFfSU5PKHNiaSkgPSBsZTMyX3RvX2NwdShyYXdfc3VwZXItPm1ldGFfaW5vKTsK
PiBAQCAtMzc2Niw3ICszNzY2LDcgQEAgc3RhdGljIHZvaWQgaW5pdF9zYl9pbmZvKHN0cnVjdCBm
MmZzX3NiX2luZm8gKnNiaSkKPiAgICAgICAgIHNiaS0+bmV4dF92aWN0aW1fc2VnW0JHX0dDXSA9
IE5VTExfU0VHTk87Cj4gICAgICAgICBzYmktPm5leHRfdmljdGltX3NlZ1tGR19HQ10gPSBOVUxM
X1NFR05POwo+ICAgICAgICAgc2JpLT5tYXhfdmljdGltX3NlYXJjaCA9IERFRl9NQVhfVklDVElN
X1NFQVJDSDsKPiAtICAgICAgIHNiaS0+bWlncmF0aW9uX2dyYW51bGFyaXR5ID0gc2JpLT5zZWdz
X3Blcl9zZWM7Cj4gKyAgICAgICBzYmktPm1pZ3JhdGlvbl9ncmFudWxhcml0eSA9IFNFR1NfUEVS
X1NFQyhzYmkpOwo+ICAgICAgICAgc2JpLT5zZXFfZmlsZV9yYV9tdWwgPSBNSU5fUkFfTVVMOwo+
ICAgICAgICAgc2JpLT5tYXhfZnJhZ21lbnRfY2h1bmsgPSBERUZfRlJBR01FTlRfU0laRTsKPiAg
ICAgICAgIHNiaS0+bWF4X2ZyYWdtZW50X2hvbGUgPSBERUZfRlJBR01FTlRfU0laRTsKPiBkaWZm
IC0tZ2l0IGEvZnMvZjJmcy9zeXNmcy5jIGIvZnMvZjJmcy9zeXNmcy5jCj4gaW5kZXggYTdlYzU1
YzdiYjIwLi45MDZkMmFmMmQ4NDkgMTAwNjQ0Cj4gLS0tIGEvZnMvZjJmcy9zeXNmcy5jCj4gKysr
IGIvZnMvZjJmcy9zeXNmcy5jCj4gQEAgLTQ5Myw4ICs0OTMsOCBAQCBzdGF0aWMgc3NpemVfdCBf
X3NiaV9zdG9yZShzdHJ1Y3QgZjJmc19hdHRyICphLAo+ICAgICAgICAgICAgICAgICBzcGluX2xv
Y2soJnNiaS0+c3RhdF9sb2NrKTsKPiAgICAgICAgICAgICAgICAgaWYgKHQgPiAodW5zaWduZWQg
bG9uZykoc2JpLT51c2VyX2Jsb2NrX2NvdW50IC0KPiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIEYyRlNfT1BUSU9OKHNiaSkucm9vdF9yZXNlcnZlZF9ibG9ja3MgLQo+IC0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgc2JpLT5ibG9ja3NfcGVyX3NlZyAqCj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBTTV9JKHNiaSktPmFkZGl0aW9uYWxfcmVzZXJ2ZWRfc2Vn
bWVudHMpKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoU01fSShzYmkpLT5h
ZGRpdGlvbmFsX3Jlc2VydmVkX3NlZ21lbnRzIDw8Cj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHNiaS0+bG9nX2Jsb2Nrc19wZXJfc2VnKSkpIHsKPiAgICAgICAgICAg
ICAgICAgICAgICAgICBzcGluX3VubG9jaygmc2JpLT5zdGF0X2xvY2spOwo+ICAgICAgICAgICAg
ICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOwo+ICAgICAgICAgICAgICAgICB9Cj4gQEAgLTU1
MSw3ICs1NTEsNyBAQCBzdGF0aWMgc3NpemVfdCBfX3NiaV9zdG9yZShzdHJ1Y3QgZjJmc19hdHRy
ICphLAo+ICAgICAgICAgfQo+Cj4gICAgICAgICBpZiAoIXN0cmNtcChhLT5hdHRyLm5hbWUsICJt
aWdyYXRpb25fZ3JhbnVsYXJpdHkiKSkgewo+IC0gICAgICAgICAgICAgICBpZiAodCA9PSAwIHx8
IHQgPiBzYmktPnNlZ3NfcGVyX3NlYykKPiArICAgICAgICAgICAgICAgaWYgKHQgPT0gMCB8fCB0
ID4gU0VHU19QRVJfU0VDKHNiaSkpCj4gICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1F
SU5WQUw7Cj4gICAgICAgICB9Cj4KPiAtLQo+IDIuNDMuMC41OTQuZ2Q5Y2Y0ZTIyN2QtZ29vZwo+
Cj4KPgo+IF9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCj4g
TGludXgtZjJmcy1kZXZlbCBtYWlsaW5nIGxpc3QKPiBMaW51eC1mMmZzLWRldmVsQGxpc3RzLnNv
dXJjZWZvcmdlLm5ldAo+IGh0dHBzOi8vbGlzdHMuc291cmNlZm9yZ2UubmV0L2xpc3RzL2xpc3Rp
bmZvL2xpbnV4LWYyZnMtZGV2ZWwKCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpMaW51eC1mMmZzLWRldmVsIG1haWxpbmcgbGlzdApMaW51eC1mMmZzLWRl
dmVsQGxpc3RzLnNvdXJjZWZvcmdlLm5ldApodHRwczovL2xpc3RzLnNvdXJjZWZvcmdlLm5ldC9s
aXN0cy9saXN0aW5mby9saW51eC1mMmZzLWRldmVsCg==
